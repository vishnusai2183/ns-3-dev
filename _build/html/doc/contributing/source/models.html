<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Submitting new models &#8212; ns-3 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="submitting-new-models">
<span id="models"></span><h1><span class="section-number">4. </span>Submitting new models<a class="headerlink" href="#submitting-new-models" title="Link to this heading">¶</a></h1>
<p>We actively encourage submission of new features to <em>ns-3</em>.
Independent submissions are essential for open source projects, and if
accepted into the mainline, you will also be credited as an author of
future versions of <em>ns-3</em>. However,
please keep in mind that there is already a large burden on the <em>ns-3</em>
maintainers to manage the flow of incoming contributions and maintain new
and existing code. The goal of this chapter is to outline the options for
new models in <em>ns-3</em>, and how you can help to minimize the burden on maintainers
and thus minimize the average time-to-merge of your code.</p>
<section id="options-for-new-models">
<h2><span class="section-number">4.1. </span>Options for new models<a class="headerlink" href="#options-for-new-models" title="Link to this heading">¶</a></h2>
<p><em>ns-3</em> is organized into modules, each of which is compiled and linked into
a separate library.  Users can selectively enable and disable the inclusion
of modules (via the <cite>–enable-modules</cite> argument to ns3 configure, or via
the selective inclusion of contributed modules).</p>
<p>When proposing new models to <em>ns-3</em>, please keep in mind that not all models
will be accepted into the mainline.  However, we aim to provide at least
one or more options for any code contribution.</p>
<p>Because of the long-term maintenance burden, <em>ns-3</em> is no longer accepting
all new proposals into the mainline.  Features that are of general
interest are more likely to be approved for the mainline, but features that
are more specialized may be recommended for the <a class="reference external" href="https://apps.nsnam.org">ns-3 App Store</a>.  Some modules that have been in the mainline for a long time, but
fall out of use (or lose their maintainers) may also be moved out of the
mainline into the App Store in the future.</p>
<p>The options for publishing new models are:</p>
<ol class="arabic simple">
<li><p>Propose a Merge Request for the <em>ns-3</em> mainline and follow the guidelines below.</p></li>
<li><p>Organize your code as a “contributed module” or modules and maintain them in
your own public Git repository.  A page on the App Store can be made to
advertise this to users, and other tooling can be used to ensure that the
module stays compatible with the mainline.</p></li>
<li><p>Organize your code as a “public fork” that evolves separately from the
<em>ns-3</em> mainline.  This option is sometimes chosen for models that require
significant intrusive changes to the <em>ns-3</em> mainline to support.  Some
recent examples include the Public Safety models and the millimeter-wave
extensions to <em>ns-3</em>.  This has the benefit of being self-contained, but
the drawback of losing compatibility with the mainline over time.  A page
on the App Store can be made for these forks as well.  For maintenance
reasons and improved user experience, we prefer to upstream mainline
changes so that public forks can be avoided.</p></li>
<li><p>Archive your code somewhere, or publish in a Git repository, and link to
it from the <em>ns-3</em> <a class="reference external" href="https://www.nsnam.org/wiki/Contributed_Code">Contributed Code</a>
wiki page.  This option requires the least amount of work from the
contributor, but visibility of the code to new <em>ns-3</em> users will likely be
reduced.  To follow this route, obtain a wiki account from the webmaster,
and make edits as appropriate to link your code.</p></li>
</ol>
<p>The remainder of the chapter concerns option 1 (upstreaming to ns-3-dev); the
other options are described in the next chapter (<a class="reference internal" href="external.html#external"><span class="std std-ref">Submitting externally maintained code</span></a>).</p>
</section>
<section id="upstreaming-new-models">
<h2><span class="section-number">4.2. </span>Upstreaming new models<a class="headerlink" href="#upstreaming-new-models" title="Link to this heading">¶</a></h2>
<p>The term “upstreaming” refers to the process whereby new code is
contributed back to an upstream source (the main open source project)
whereby that project takes responsibility for further enhancement and
maintenance.</p>
<p>Making sure that each code submission fulfills as many items
as possible in the following checklist is the best way to ensure quick
merging of your code.</p>
<p>In brief, we can summarize the guidelines as follows:</p>
<ol class="arabic simple">
<li><p>Be licensed appropriately (see <a class="reference internal" href="general.html#general"><span class="std std-ref">General</span></a>)</p></li>
<li><p>Understand how and why <em>ns-3</em> conducts code reviews before merging</p></li>
<li><p>Follow the ns-3 coding style (<a class="reference internal" href="coding-style.html#coding-style"><span class="std std-ref">Coding style</span></a>) and software
engineering and consistency feedback that maintainers may provide</p></li>
<li><p>Write associated documentation, tests, and example programs</p></li>
</ol>
<p>If you do not have the time to follow through the process to include your
code in the main tree, please see the next chapter (<a class="reference internal" href="external.html#external"><span class="std std-ref">Submitting externally maintained code</span></a>)
about contributing ns-3 code that is not maintained in the main tree.</p>
<p>The process can take a long time when submissions are large or when
contributors skip some of these steps.  Therefore, best results are found
when the following guidelines are followed:</p>
<ul class="simple">
<li><p>Ask for review of small chunks of code, rather than large patches.  Split
large submissions into several more manageable pieces.</p></li>
<li><p>Make sure that the code follows the guidelines (coding style,
documentation, tests, examples) or you may be asked to fix these
things before maintainers look at it again.</p></li>
</ul>
</section>
<section id="code-reviews">
<h2><span class="section-number">4.3. </span>Code reviews<a class="headerlink" href="#code-reviews" title="Link to this heading">¶</a></h2>
<p>Code submissions to ns-3-dev are expected to go through a review process
where one or more maintainers comment on the code.  The basic purpose of the
code reviews is to ensure the long-term maintenance and overall system
integrity of ns-3.  Contributors may be asked
to revise their code or rewrite portions during this process. New features are
also typically only merged during the early stages of a new release cycle,
to avoid destabilizing code before release.</p>
<p><em>ns-3</em> code reviews are conducted using GitLab.com merge requests, possibly
supported by discussion on the ns-developers mailing list for reviews that
involve code that cuts across maintainer boundaries or is otherwise
controversial.  Many examples of ongoing reviews can be browsed on
our <a class="reference external" href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests">GitLab.com site</a>.</p>
</section>
<section id="submission-structure">
<h2><span class="section-number">4.4. </span>Submission structure<a class="headerlink" href="#submission-structure" title="Link to this heading">¶</a></h2>
<p>For each code submission, include a description of what your code is doing,
and why. Ideally, you should be able to provide a summary description in a
short paragraph at the top of the Merge Request.  If you want to flag
to maintainers that your submission is known to be incomplete (e.g., you
are looking for early feedback), preface the title of the Merge Request
with <code class="docutils literal notranslate"><span class="pre">Draft:</span></code>.</p>
<section id="coherent-and-multi-part-submissions">
<h3><span class="section-number">4.4.1. </span>Coherent and multi-part submissions<a class="headerlink" href="#coherent-and-multi-part-submissions" title="Link to this heading">¶</a></h3>
<p>Large code submissions should be split into smaller submissions where possible.
The likelihood of getting maintainers to review your submission is inversely
proportional to its size, because large code reviews require a large block
of time for a maintainer.  For instance, if you are submitting two
routing protocol models and each protocol model can stand on its own,
submit two Merge Requests rather than a single one containing both models.</p>
<p>Each submission should be a coherent whole: if you need to edit ten files to
get a feature to work, then, the submission should contain all the changes
for these ten files.  Of course, if you can split the feature in sub-features,
then, you should do it to decrease the size of the submission as per the
previous paragraph.</p>
<p>For example, if you have made changes to optimize one module, and in the
course of doing so, you fixed a bug in another module, make sure you separate
these two sets of changes in two separate submissions.</p>
<p>When splitting a large submission into separate submissions, (ideally) these
submissions should be prefaced (in the Merge Request description) by a
detailed explanation of the overall plan
such that code reviewers can review each submission separately but within a
larger context. This kind of submission typically is split in multiple dependent
steps where each step depends on the previous one. If this is the case,
make it very clear in your initial explanation. If you can, minimize
dependencies between each step such that reviewers can merge each step
separately without having to consider the impact of merging one submission
on other submissions.</p>
</section>
<section id="history-rewriting">
<h3><span class="section-number">4.4.2. </span>History rewriting<a class="headerlink" href="#history-rewriting" title="Link to this heading">¶</a></h3>
<p>It is good practice to rebase your feature branch onto the tip of the
(evolving) ns-3-dev, so that the commits appear on top of a recent commit
of ns-3-dev.  For instance, you may have started with an initial Merge
Request, and it has been some time to gather feedback from maintainers,
and now you want to update your Merge Request with that feedback.  A
rebase onto the current ns-3-dev <code class="docutils literal notranslate"><span class="pre">master</span></code> branch is good practice
for any Merge Request update.</p>
<p>In addition, in the course of your development, and in responding to
reviewer comments, the git commit log will accumulate lots of small
commits that are not helpful to future maintainers:  they make it more painful
to use the annotate and bisect commands.  For this reason, it is good
practice to “squash” and “rebase” commits into coherent groups.  For example,
assume that the commit history, after you have responded to a reviewer’s
comment, looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">commit</span> <span class="mi">4938</span><span class="n">c01400fb961c37716c3f415f47ba2b04ab5f</span> <span class="p">(</span><span class="n">HEAD</span> <span class="o">-&gt;</span> <span class="n">master</span><span class="p">,</span> <span class="n">origin</span><span class="o">/</span><span class="n">master</span><span class="p">,</span> <span class="n">origin</span><span class="o">/</span><span class="n">HEAD</span><span class="p">)</span>
<span class="n">Author</span><span class="p">:</span> <span class="n">Some</span> <span class="n">Contributor</span> <span class="o">&lt;</span><span class="n">some</span><span class="o">.</span><span class="n">contributor</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">Date</span><span class="p">:</span>   <span class="n">Mon</span> <span class="n">Jun</span> <span class="mi">15</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2020</span> <span class="o">-</span><span class="mi">0700</span>

  <span class="n">Fix</span> <span class="n">typo</span> <span class="ow">in</span> <span class="n">Doxygen</span> <span class="n">based</span> <span class="n">on</span> <span class="n">code</span> <span class="n">review</span> <span class="n">comment</span>

<span class="n">commit</span> <span class="mi">915</span><span class="n">cf65cb8f464d9398ddd8bea9af167ced64663</span>
<span class="n">Author</span><span class="p">:</span> <span class="n">Some</span> <span class="n">Contributor</span> <span class="o">&lt;</span><span class="n">some</span><span class="o">.</span><span class="n">contributor</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">Date</span><span class="p">:</span>   <span class="n">Thu</span> <span class="n">Jun</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">46</span> <span class="mi">2020</span> <span class="o">-</span><span class="mi">0400</span>

  <span class="n">Add</span> <span class="n">documentation</span><span class="p">,</span> <span class="n">tests</span><span class="p">,</span> <span class="ow">and</span> <span class="n">examples</span> <span class="k">for</span> <span class="n">clever</span> <span class="n">protocol</span>

<span class="n">commit</span> <span class="n">a1d51db126fb3d1c7c76427473f02ee792fdfd53</span>
<span class="n">Author</span><span class="p">:</span> <span class="n">Some</span> <span class="n">Contributor</span> <span class="o">&lt;</span><span class="n">some</span><span class="o">.</span><span class="n">contributor</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">Date</span><span class="p">:</span>   <span class="n">Thu</span> <span class="n">Jun</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">48</span> <span class="mi">2020</span> <span class="o">-</span><span class="mi">0400</span>

  <span class="n">Add</span> <span class="n">new</span> <span class="n">models</span> <span class="k">for</span> <span class="n">clever</span> <span class="n">protocol</span>
</pre></div>
</div>
<p>In the above case, it will be helpful to squash the top commit about the
typo into the first commit where the Doxygen was first written, leaving
you again with two commits.  <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History">Git interactive rebase</a> is a good tool for this;
ask a maintainer for help in doing this if you need some help to learn
this process.</p>
</section>
</section>
<section id="documentation-tests-and-examples">
<h2><span class="section-number">4.5. </span>Documentation, tests, and examples<a class="headerlink" href="#documentation-tests-and-examples" title="Link to this heading">¶</a></h2>
<p>Often we have observed that contributors will provide nice new classes
implementing a new model, but will fail to include supporting test code,
example scripts, and documentation. Therefore, we ask people submitting the
code (who are in the best position to do this type of work) to provide
documentation, test code, and example scripts.</p>
<p>Note that you may want to go through multiple phases of code reviews, and
all of this supporting material may not be needed at the first stage (e.g.
when you want some feedback on public API header declarations only, before
starting the implementation). However, when it times come to merge your code,
you should be prepared to provide these things, as fits your contribution
(maintainers will provide some guidance here).</p>
<section id="including-examples">
<h3><span class="section-number">4.5.1. </span>Including examples<a class="headerlink" href="#including-examples" title="Link to this heading">¶</a></h3>
<p>For many submissions, it will be important to include at least one example that exercises the new code, so the reviewer understands how it is intended to be used. For final submission, please consider to add as many examples as you can that will help new users of your code. The &lt;tt&gt;samples/&lt;/tt&gt; and &lt;tt&gt;examples/&lt;/tt&gt; directories are places for these files.</p>
</section>
<section id="tests">
<h3><span class="section-number">4.5.2. </span>Tests<a class="headerlink" href="#tests" title="Link to this heading">¶</a></h3>
<p>All new models should include automated tests.  These should, where
appropriate, be unit tests of model correctness, validation tests of
stochastic behavior, and overall system tests if the model’s interaction with
other components must be tested.  The test code should try to cover as much
model code as possible, and should be checked as much as possible by
regression tests.</p>
<p>The ns-3 manual provides documentation and suggestions for
<a class="reference external" href="https://www.nsnam.org/docs//manual/html/how-to-write-tests.html">how to write tests</a>.</p>
</section>
<section id="documentation">
<h3><span class="section-number">4.5.3. </span>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h3>
<p>If you add a new features, or make changes to existing features, you need to
update existing or write new documentation and example code. Consider the
following checklist:</p>
<ul class="simple">
<li><p>Doxygen should be added to header files for all public classes and methods, and should be checked for Doxygen errors</p></li>
<li><p>new features should be described in the <code class="docutils literal notranslate"><span class="pre">RELEASE_NOTES.md</span></code></p></li>
<li><p>public API changes (if any) must be documented in <code class="docutils literal notranslate"><span class="pre">CHANGES.html</span></code></p></li>
<li><p>new API or changes to existing API must update the inline doxygen documentation in header files</p></li>
<li><p>consider updating or adding a new section to the manual (<code class="docutils literal notranslate"><span class="pre">doc/manual</span></code>) or
model library (<code class="docutils literal notranslate"><span class="pre">doc/models</span></code>) as appropriate</p></li>
<li><p>update the <code class="docutils literal notranslate"><span class="pre">AUTHORS</span></code> file for any new authors</p></li>
</ul>
</section>
<section id="module-dependencies">
<h3><span class="section-number">4.5.4. </span>Module dependencies<a class="headerlink" href="#module-dependencies" title="Link to this heading">¶</a></h3>
<p>Since <em>ns-3</em> is a modular system, each module has (typically) dependencies on
other modules. These must be kept to the minimum necessary, and circular
dependencies must be avoided (they will generate errors).
As an example, the <code class="docutils literal notranslate"><span class="pre">lr-wpan</span></code> module depends on <code class="docutils literal notranslate"><span class="pre">core</span></code>, <code class="docutils literal notranslate"><span class="pre">network</span></code>,
<code class="docutils literal notranslate"><span class="pre">mobility</span></code>, <code class="docutils literal notranslate"><span class="pre">spectrum</span></code>, and <code class="docutils literal notranslate"><span class="pre">propagation</span></code>. Tests for your new module
must not add any other dependency (that was not needed for the model or
helper code itself), but examples can use other modules because their module
dependencies are handled independently. As an example, the <code class="docutils literal notranslate"><span class="pre">lr-wpan</span></code> examples
also use the <code class="docutils literal notranslate"><span class="pre">stats</span></code> module.</p>
<p>This rule might pose limitations to the authoring of tests. In such a case,
ask a maintainer for suggestions, or check existing tests to find solutions.
Sometimes tests that involve adding additional dependencies are placed into
the <code class="docutils literal notranslate"><span class="pre">src/test</span></code> subdirectory.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ns-3</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, vishnu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/doc/contributing/source/models.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>