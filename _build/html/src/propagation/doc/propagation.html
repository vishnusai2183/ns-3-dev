<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Propagation &#8212; ns-3 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="propagation">
<span id="id1"></span><h1>Propagation<a class="headerlink" href="#propagation" title="Link to this heading">¶</a></h1>
<p>The <a href="#id31"><span class="problematic" id="id32">|ns3|</span></a> <code class="docutils literal notranslate"><span class="pre">propagation</span></code> module defines two generic interfaces, namely <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">PropagationLossModel</span></code>
and <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">PropagationDelayModel</span></code>, to model respectively the propagation loss and the propagation delay.</p>
<section id="propagationlossmodel">
<h2>PropagationLossModel<a class="headerlink" href="#propagationlossmodel" title="Link to this heading">¶</a></h2>
<p>Propagation loss models calculate the Rx signal power considering the Tx signal power and the
mutual Rx and Tx antennas positions.</p>
<p>A propagation loss model can be “chained” to another one, making a list. The final Rx power
takes into account all the chained models. In this way one can use a slow fading and a fast
fading model (for example), or model separately different fading effects.</p>
<p>The following propagation loss models are implemented:</p>
<blockquote>
<div><ul>
<li><p>Cost231PropagationLossModel</p></li>
<li><p>FixedRssLossModel</p></li>
<li><p>FriisPropagationLossModel</p></li>
<li><p>ItuR1411LosPropagationLossModel</p></li>
<li><p>ItuR1411NlosOverRooftopPropagationLossModel</p></li>
<li><p>JakesPropagationLossModel</p></li>
<li><p>Kun2600MhzPropagationLossModel</p></li>
<li><p>LogDistancePropagationLossModel</p></li>
<li><p>MatrixPropagationLossModel</p></li>
<li><p>NakagamiPropagationLossModel</p></li>
<li><p>OkumuraHataPropagationLossModel</p></li>
<li><p>RandomPropagationLossModel</p></li>
<li><p>RangePropagationLossModel</p></li>
<li><p>ThreeLogDistancePropagationLossModel</p></li>
<li><p>TwoRayGroundPropagationLossModel</p></li>
<li><p>ThreeGppPropagationLossModel</p>
<blockquote>
<div><ul class="simple">
<li><p>ThreeGppRMaPropagationLossModel</p></li>
<li><p>ThreeGppUMaPropagationLossModel</p></li>
<li><p>ThreeGppUmiStreetCanyonPropagationLossModel</p></li>
<li><p>ThreeGppIndoorOfficePropagationLossModel</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>Other models could be available thanks to other modules, e.g., the <code class="docutils literal notranslate"><span class="pre">building</span></code> module.</p>
<p>Each of the available propagation loss models of ns-3 is explained in
one of the following subsections.</p>
<section id="friispropagationlossmodel">
<h3>FriisPropagationLossModel<a class="headerlink" href="#friispropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model implements the Friis propagation loss model. This model was first described in <a class="reference internal" href="#friis" id="id2"><span>[friis]</span></a>.
The original equation was described as:</p>
<div class="math notranslate nohighlight">
\[\frac{P_r}{P_t} = \frac{A_r A_t}{d^2\lambda^2}\]</div>
<p>with the following equation for the case of an isotropic antenna with no heat loss:</p>
<div class="math notranslate nohighlight">
\[A_{isotr.} = \frac{\lambda^2}{4\pi}\]</div>
<p>The final equation becomes:</p>
<div class="math notranslate nohighlight">
\[\frac{P_r}{P_t} = \frac{\lambda^2}{(4 \pi d)^2}\]</div>
<p>Modern extensions to this original equation are:</p>
<div class="math notranslate nohighlight">
\[P_r = \frac{P_t G_t G_r \lambda^2}{(4 \pi d)^2 L}\]</div>
<p>With:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(P_t\)</span> : transmission power (W)</p>
<p><span class="math notranslate nohighlight">\(P_r\)</span> : reception power (W)</p>
<p><span class="math notranslate nohighlight">\(G_t\)</span> : transmission gain (unit-less)</p>
<p><span class="math notranslate nohighlight">\(G_r\)</span> : reception gain (unit-less)</p>
<p><span class="math notranslate nohighlight">\(\lambda\)</span> : wavelength (m)</p>
<p><span class="math notranslate nohighlight">\(d\)</span> : distance (m)</p>
<p><span class="math notranslate nohighlight">\(L\)</span> : system loss (unit-less)</p>
</div></blockquote>
<p>In the implementation, <span class="math notranslate nohighlight">\(\lambda\)</span> is calculated as
<span class="math notranslate nohighlight">\(\frac{C}{f}\)</span>, where <span class="math notranslate nohighlight">\(C = 299792458\)</span> m/s is the speed of light in
vacuum, and <span class="math notranslate nohighlight">\(f\)</span> is the frequency in Hz which can be configured by
the user via the Frequency attribute.</p>
<p>The Friis model is valid only for propagation in free space within
the so-called far field region, which can be considered
approximately as the region for <span class="math notranslate nohighlight">\(d &gt; 3 \lambda\)</span>.
The model will still return a value for <span class="math notranslate nohighlight">\(d &lt; 3 \lambda\)</span>, as
doing so (rather than triggering a fatal error) is practical for
many simulation scenarios. However, we stress that the values
obtained in such conditions shall not be considered realistic.</p>
<p>Related with this issue, we note that the Friis formula is
undefined for <span class="math notranslate nohighlight">\(d = 0\)</span>, and results in
<span class="math notranslate nohighlight">\(P_r &gt; P_t\)</span> for <span class="math notranslate nohighlight">\(d &lt; \lambda / 2 \sqrt{\pi}\)</span>.</p>
<p>Both these conditions occur outside of the far field region, so in
principle the Friis model shall not be used in these conditions.
In practice, however, Friis is often used in scenarios where accurate
propagation modeling is not deemed important, and values of
<span class="math notranslate nohighlight">\(d = 0\)</span> can occur.</p>
<p>To allow practical use of the model in such
scenarios, we have to 1) return some value for <span class="math notranslate nohighlight">\(d = 0\)</span>, and
2) avoid large discontinuities in propagation loss values (which
could lead to artifacts such as bogus capture effects which are
much worse than inaccurate propagation loss values). The two issues
are conflicting, as, according to the Friis formula,
<span class="math notranslate nohighlight">\(\lim_{d \to 0}  P_r = +\infty\)</span>;
so if, for <span class="math notranslate nohighlight">\(d = 0\)</span>, we use a fixed loss value, we end up with an infinitely large
discontinuity, which as we discussed can cause undesirable
simulation artifacts.</p>
<p>To avoid these artifact, this implementation of the Friis model
provides an attribute called MinLoss which allows to specify the
minimum total loss (in dB) returned by the model. This is used in
such a way that
<span class="math notranslate nohighlight">\(P_r\)</span> continuously increases for <span class="math notranslate nohighlight">\(d \to 0\)</span>, until
MinLoss is reached, and then stay constant; this allow to
return a value for <span class="math notranslate nohighlight">\(d = 0\)</span> and at the same time avoid
discontinuities. The model won’t be much realistic, but at least
the simulation artifacts discussed before are avoided. The default value of
MinLoss is 0 dB, which means that by default the model will return
<span class="math notranslate nohighlight">\(P_r = P_t\)</span> for <span class="math notranslate nohighlight">\(d &lt;= \lambda / 2 \sqrt{\pi}\)</span>.
We note that this value of <span class="math notranslate nohighlight">\(d\)</span> is outside of the far field
region, hence the validity of the model in the far field region is
not affected.</p>
</section>
<section id="tworaygroundpropagationlossmodel">
<h3>TwoRayGroundPropagationLossModel<a class="headerlink" href="#tworaygroundpropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model implements a Two-Ray Ground propagation loss model ported from NS2</p>
<p>The Two-ray ground reflection model uses the formula</p>
<div class="math notranslate nohighlight">
\[P_r = \frac{P_t * G_t * G_r * (H_t^2 * H_r^2)}{d^4 * L}\]</div>
<p>The original equation in Rappaport’s book assumes <span class="math notranslate nohighlight">\(L = 1\)</span>.
To be consistent with the free space equation, <span class="math notranslate nohighlight">\(L\)</span> is added here.</p>
<p><span class="math notranslate nohighlight">\(H_t\)</span> and <span class="math notranslate nohighlight">\(H_r\)</span> are set at the respective nodes <span class="math notranslate nohighlight">\(z\)</span> coordinate plus a model parameter
set via SetHeightAboveZ.</p>
<p>The two-ray model does not give a good result for short distances, due to the
oscillation caused by constructive and destructive combination of the two
rays. Instead the Friis free-space model is used for small distances.</p>
<p>The crossover distance, below which Friis is used, is calculated as follows:</p>
<div class="math notranslate nohighlight">
\[dCross = \frac{(4 * \pi * H_t * H_r)}{\lambda}\]</div>
<p>In the implementation,  <span class="math notranslate nohighlight">\(\lambda\)</span> is calculated as
<span class="math notranslate nohighlight">\(\frac{C}{f}\)</span>, where <span class="math notranslate nohighlight">\(C = 299792458\)</span> m/s is the speed of light in
vacuum, and <span class="math notranslate nohighlight">\(f\)</span> is the frequency in Hz which can be configured by
the user via the Frequency attribute.</p>
</section>
<section id="logdistancepropagationlossmodel">
<h3>LogDistancePropagationLossModel<a class="headerlink" href="#logdistancepropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model implements a log distance propagation model.</p>
<p>The reception power is calculated with a so-called
log-distance propagation model:</p>
<div class="math notranslate nohighlight">
\[L = L_0 + 10 n \log(\frac{d}{d_0})\]</div>
<p>where:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(n\)</span> : the path loss distance exponent</p>
<p><span class="math notranslate nohighlight">\(d_0\)</span> : reference distance (m)</p>
<p><span class="math notranslate nohighlight">\(L_0\)</span> : path loss at reference distance (dB)</p>
<p><span class="math notranslate nohighlight">\(d\)</span> :  - distance (m)</p>
<p><span class="math notranslate nohighlight">\(L\)</span> : path loss (dB)</p>
</div></blockquote>
<p>When the path loss is requested at a distance smaller than
the reference distance, the tx power is returned.</p>
</section>
<section id="threelogdistancepropagationlossmodel">
<h3>ThreeLogDistancePropagationLossModel<a class="headerlink" href="#threelogdistancepropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model implements a log distance path loss propagation model with three distance
fields. This model is the same as ns3::LogDistancePropagationLossModel
except that it has three distance fields: near, middle and far with
different exponents.</p>
<p>Within each field the reception power is calculated using the log-distance
propagation equation:</p>
<div class="math notranslate nohighlight">
\[L = L_0 + 10 \cdot n_0 \log_{10}(\frac{d}{d_0})\]</div>
<p>Each field begins where the previous ends and all together form a continuous function.</p>
<p>There are three valid distance fields: near, middle, far. Actually four: the
first from 0 to the reference distance is invalid and returns txPowerDbm.</p>
<div class="math notranslate nohighlight">
\[\underbrace{0 \cdots\cdots}_{=0} \underbrace{d_0 \cdots\cdots}_{n_0} \underbrace{d_1 \cdots\cdots}_{n_1} \underbrace{d_2 \cdots\cdots}_{n_2} \infty\]</div>
<p>Complete formula for the path loss in dB:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle L =
\begin{cases}
0 &amp; d &lt; d_0 \\
L_0 + 10 \cdot n_0 \log_{10}(\frac{d}{d_0}) &amp; d_0 \leq d &lt; d_1 \\
L_0 + 10 \cdot n_0 \log_{10}(\frac{d_1}{d_0}) + 10 \cdot n_1 \log_{10}(\frac{d}{d_1}) &amp; d_1 \leq d &lt; d_2 \\
L_0 + 10 \cdot n_0 \log_{10}(\frac{d_1}{d_0}) + 10 \cdot n_1 \log_{10}(\frac{d_2}{d_1}) + 10 \cdot n_2 \log_{10}(\frac{d}{d_2})&amp; d_2 \leq d
\end{cases}\end{split}\]</div>
<p>where:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(d_0, d_1, d_2\)</span> : three distance fields (m)</p>
<p><span class="math notranslate nohighlight">\(n_0, n_1, n_2\)</span> : path loss distance exponent for each field (unitless)</p>
<p><span class="math notranslate nohighlight">\(L_0\)</span> : path loss at reference distance (dB)</p>
<p><span class="math notranslate nohighlight">\(d\)</span> :  - distance (m)</p>
<p><span class="math notranslate nohighlight">\(L\)</span> : path loss (dB)</p>
</div></blockquote>
<p>When the path loss is requested at a distance smaller than the reference
distance <span class="math notranslate nohighlight">\(d_0\)</span>, the tx power (with no path loss) is returned. The
reference distance defaults to 1m and reference loss defaults to
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">FriisPropagationLossModel</span></code> with 5.15 GHz and is thus <span class="math notranslate nohighlight">\(L_0\)</span> = 46.67 dB.</p>
</section>
<section id="jakespropagationlossmodel">
<h3>JakesPropagationLossModel<a class="headerlink" href="#jakespropagationlossmodel" title="Link to this heading">¶</a></h3>
<section id="todo">
<h4>ToDo<a class="headerlink" href="#todo" title="Link to this heading">¶</a></h4>
</section>
</section>
<section id="randompropagationlossmodel">
<h3>RandomPropagationLossModel<a class="headerlink" href="#randompropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>The propagation loss is totally random, and it changes each time the model is called.
As a consequence, all the packets (even those between two fixed nodes) experience a random
propagation loss.</p>
</section>
<section id="nakagamipropagationlossmodel">
<h3>NakagamiPropagationLossModel<a class="headerlink" href="#nakagamipropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This propagation loss model implements the Nakagami-m fast fading
model, which accounts for the variations in signal strength due to multipath
fading. The model does not account for the path loss due to the
distance traveled by the signal, hence for typical simulation usage it
is recommended to consider using it in combination with other models
that take into account this aspect.</p>
<p>The Nakagami-m distribution is applied to the power level. The probability density function is defined as</p>
<div class="math notranslate nohighlight">
\[p(x; m, \omega) = \frac{2 m^m}{\Gamma(m) \omega^m} x^{2m - 1} e^{-\frac{m}{\omega} x^2} )\]</div>
<p>with <span class="math notranslate nohighlight">\(m\)</span> the fading depth parameter and <span class="math notranslate nohighlight">\(\omega\)</span> the average received power.</p>
<p>It is implemented by either a <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">GammaRandomVariable</span></code> or a <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ErlangRandomVariable</span></code>
random variable.</p>
<p>The implementation of the model allows to specify different values of
the <span class="math notranslate nohighlight">\(m\)</span> parameter (and hence different fast fading profiles)
for three different distance ranges:</p>
<div class="math notranslate nohighlight">
\[\underbrace{0 \cdots\cdots}_{m_0} \underbrace{d_1 \cdots\cdots}_{m_1} \underbrace{d_2 \cdots\cdots}_{m_2} \infty\]</div>
<p>For <span class="math notranslate nohighlight">\(m = 1\)</span> the Nakagami-m distribution equals the Rayleigh distribution. Thus
this model also implements Rayleigh distribution based fast fading.</p>
</section>
<section id="fixedrsslossmodel">
<h3>FixedRssLossModel<a class="headerlink" href="#fixedrsslossmodel" title="Link to this heading">¶</a></h3>
<p>This model sets a constant received power level independent of the transmit power.</p>
<p>The received power is constant independent of the transmit power; the user
must set received power level.  Note that if this loss model is chained to other loss
models, it should be the first loss model in the chain.
Else it will disregard the losses computed by loss models that precede it in the chain.</p>
</section>
<section id="matrixpropagationlossmodel">
<h3>MatrixPropagationLossModel<a class="headerlink" href="#matrixpropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>The propagation loss is fixed for each pair of nodes and doesn’t depend on their actual positions.
This model should be useful for synthetic tests. Note that by default the propagation loss is
assumed to be symmetric.</p>
</section>
<section id="rangepropagationlossmodel">
<h3>RangePropagationLossModel<a class="headerlink" href="#rangepropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This propagation loss depends only on the distance (range) between transmitter and receiver.</p>
<p>The single MaxRange attribute (units of meters) determines path loss.
Receivers at or within MaxRange meters receive the transmission at the
transmit power level. Receivers beyond MaxRange receive at power
-1000 dBm (effectively zero).</p>
</section>
<section id="okumurahatapropagationlossmodel">
<h3>OkumuraHataPropagationLossModel<a class="headerlink" href="#okumurahatapropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model is used to model open area pathloss for long distance (i.e., &gt; 1 Km).
In order to include all the possible frequencies usable by LTE we need to consider
several variants of the well known Okumura Hata model. In fact, the original Okumura
Hata model <a class="reference internal" href="#hata" id="id3"><span>[hata]</span></a> is designed for frequencies ranging from 150 MHz to 1500 MHz,
the COST231 <a class="reference internal" href="#cost231" id="id4"><span>[cost231]</span></a> extends it for the frequency range from 1500 MHz to 2000 MHz.
Another important aspect is the scenarios considered by the models, in fact the all
models are originally designed for urban scenario and then only the standard one and
the COST231 are extended to suburban, while only the standard one has been extended
to open areas. Therefore, the model cannot cover all scenarios at all frequencies.
In the following we detail the models adopted.</p>
<p>The pathloss expression of the COST231 OH is:</p>
<div class="math notranslate nohighlight">
\[L = 46.3 + 33.9\log{f} - 13.82 \log{h_\mathrm{b}} + (44.9 - 6.55\log{h_\mathrm{b}})\log{d} - F(h_\mathrm{M}) + C\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(h_\mathrm{M}) = \left\{\begin{array}{ll} (1.1\log(f))-0.7 \times h_\mathrm{M} - (1.56\times \log(f)-0.8) &amp; \mbox{for medium and small size cities} \\ 3.2\times (\log{(11.75\times h_\mathrm{M}}))^2 &amp; \mbox{for large cities}\end{array} \right.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}C = \left\{\begin{array}{ll} 0dB &amp; \mbox{for medium-size cities and suburban areas} \\ 3dB &amp; \mbox{for large cities}\end{array} \right.\end{split}\]</div>
<p>and</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(f\)</span> : frequency [MHz]</p>
<p><span class="math notranslate nohighlight">\(h_\mathrm{b}\)</span> : eNB height above the ground [m]</p>
<p><span class="math notranslate nohighlight">\(h_\mathrm{M}\)</span> : UE height above the ground [m]</p>
<p><span class="math notranslate nohighlight">\(d\)</span> : distance [km]</p>
<p><span class="math notranslate nohighlight">\(log\)</span> : is a logarithm in base 10 (this for the whole document)</p>
</div></blockquote>
<p>This model is only for urban scenarios.</p>
<p>The pathloss expression of the standard OH in urban area is:</p>
<div class="math notranslate nohighlight">
\[L = 69.55 + 26.16\log{f} - 13.82 \log{h_\mathrm{b}} + (44.9 - 6.55\log{h_\mathrm{b}})\log{d} - C_\mathrm{H}\]</div>
<p>where for small or medium sized city</p>
<div class="math notranslate nohighlight">
\[C_\mathrm{H} = 0.8 + (1.1\log{f} - 0.7)h_\mathrm{M} -1.56\log{f}\]</div>
<p>and for large cities</p>
<div class="math notranslate nohighlight">
\[\begin{split}C_\mathrm{H} = \left\{\begin{array}{ll} 8.29 (\log{(1.54h_M)})^2 -1.1 &amp; \mbox{if } 150\leq f\leq 200 \\ 3.2(\log{(11.75h_M)})^2 -4.97 &amp; \mbox{if } 200&lt;f\leq 1500\end{array} \right.\end{split}\]</div>
<p>There extension for the standard OH in suburban is</p>
<div class="math notranslate nohighlight">
\[L_\mathrm{SU} = L_\mathrm{U} - 2 \left(\log{\frac{f}{28}}\right)^2 - 5.4\]</div>
<p>where</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(L_\mathrm{U}\)</span> : pathloss in urban areas</p>
</div></blockquote>
<p>The extension for the standard OH in open area is</p>
<div class="math notranslate nohighlight">
\[L_\mathrm{O} = L_\mathrm{U} - 4.70 (\log{f})^2 + 18.33\log{f} - 40.94\]</div>
<p>The literature lacks of extensions of the COST231 to open area (for suburban it seems that
we can just impose C = 0); therefore we consider it a special case of the suburban one.</p>
</section>
<section id="cost231propagationlossmodel">
<h3>Cost231PropagationLossModel<a class="headerlink" href="#cost231propagationlossmodel" title="Link to this heading">¶</a></h3>
<section id="id5">
<h4>ToDo<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
</section>
</section>
<section id="itur1411lospropagationlossmodel">
<h3>ItuR1411LosPropagationLossModel<a class="headerlink" href="#itur1411lospropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model is designed for Line-of-Sight (LoS) short range outdoor communication in the
frequency range 300 MHz to 100 GHz.  This model provides an upper and lower bound
respectively according to the following formulas</p>
<div class="math notranslate nohighlight">
\[\begin{split}L_\mathrm{LoS,l} = L_\mathrm{bp} + \left\{\begin{array}{ll} 20\log{\frac{d}{R_\mathrm{bp}}} &amp; \mbox{for $d \le R_\mathrm{bp}$} \\ 40\log{\frac{d}{R_\mathrm{bp}}} &amp; \mbox{for $d &gt; R_\mathrm{bp}$}\end{array} \right.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}L_\mathrm{LoS,u} = L_\mathrm{bp} + 20 + \left\{\begin{array}{ll} 25\log{\frac{d}{R_\mathrm{bp}}} &amp; \mbox{for $d \le R_\mathrm{bp}$} \\ 40\log{\frac{d}{R_\mathrm{bp}}} &amp; \mbox{for $d &gt; R_\mathrm{bp}$}\end{array} \right.\end{split}\]</div>
<p>where the breakpoint distance is given by</p>
<div class="math notranslate nohighlight">
\[R_\mathrm{bp} \approx \frac{4h_\mathrm{b}h_\mathrm{m}}{\lambda}\]</div>
<p>and the above parameters are</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\lambda\)</span> : wavelength [m]</p>
<p><span class="math notranslate nohighlight">\(h_\mathrm{b}\)</span> : eNB height above the ground [m]</p>
<p><span class="math notranslate nohighlight">\(h_\mathrm{m}\)</span> : UE height above the ground [m]</p>
<p><span class="math notranslate nohighlight">\(d\)</span> : distance [m]</p>
</div></blockquote>
<p>and <span class="math notranslate nohighlight">\(L_{bp}\)</span> is the value for the basic transmission loss at the break point, defined as:</p>
<div class="math notranslate nohighlight">
\[L_{bp} = \left|20\log \left(\frac{\lambda^2}{8\pi h_\mathrm{b}h\mathrm{m}}\right)\right|\]</div>
<p>The value used by the simulator is the average one for modeling the median pathloss.</p>
</section>
<section id="itur1411nlosoverrooftoppropagationlossmodel">
<h3>ItuR1411NlosOverRooftopPropagationLossModel<a class="headerlink" href="#itur1411nlosoverrooftoppropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This model is designed for Non-Line-of-Sight (LoS) short range outdoor communication over
rooftops in the frequency range 300 MHz to 100 GHz. This model includes several scenario-dependent
parameters, such as average street width, orientation, etc. It is advised to set the values of
these parameters manually (using the ns-3 attribute system) according to the desired scenario.</p>
<p>In detail, the model is based on <a class="reference internal" href="#walfisch" id="id6"><span>[walfisch]</span></a> and <a class="reference internal" href="#ikegami" id="id7"><span>[ikegami]</span></a>, where the loss is expressed
as the sum of free-space loss (<span class="math notranslate nohighlight">\(L_{bf}\)</span>), the diffraction loss from rooftop to
street (<span class="math notranslate nohighlight">\(L_{rts}\)</span>) and the reduction due to multiple screen diffraction past
rows of building (<span class="math notranslate nohighlight">\(L_{msd}\)</span>). The formula is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}L_{NLOS1} = \left\{ \begin{array}{ll} L_{bf} + L_{rts} + L_{msd} &amp; \mbox{for } L_{rts} + L_{msd} &gt; 0 \\ L_{bf} &amp; \mbox{for } L_{rts} + L_{msd} \le 0\end{array}\right.\end{split}\]</div>
<p>The free-space loss is given by:</p>
<div class="math notranslate nohighlight">
\[L_{bf} = 32.4 + 20 \log {(d/1000)} + 20\log{(f)}\]</div>
<p>where:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(f\)</span> : frequency [MHz]</p>
<p><span class="math notranslate nohighlight">\(d\)</span> : distance (where <span class="math notranslate nohighlight">\(d &gt; 1\)</span>) [m]</p>
</div></blockquote>
<p>The term <span class="math notranslate nohighlight">\(L_{rts}\)</span> takes into account the width of the street and its orientation, according to the formulas</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L_{rts} = -8.2 - 10\log {(w)} + 10\log{(f)} + 20\log{(\Delta h_m)} + L_{ori}\\\begin{split}L_{ori} = \left\{ \begin{array}{lll} -10 + 0.354\varphi &amp; \mbox{for } 0^{\circ} \le \varphi &lt; 35^{\circ} \\ 2.5 + 0.075(\varphi-35) &amp; \mbox{for } 35^{\circ} \le \varphi &lt; 55^{\circ} \\ 4.0 -0.114(\varphi-55) &amp; \mbox{for } 55^{\circ} \varphi \le 90^{\circ}\end{array}\right.\end{split}\\\Delta h_m = h_r - h_m\end{aligned}\end{align} \]</div>
<p>where:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(h_r\)</span> : is the height of the rooftop [m]</p>
<p><span class="math notranslate nohighlight">\(h_m\)</span> : is the height of the mobile [m]</p>
<p><span class="math notranslate nohighlight">\(\varphi\)</span> : is the street orientation with respect to the direct path (degrees)</p>
</div></blockquote>
<p>The multiple screen diffraction loss depends on the BS antenna height relative to the building
height and on the incidence angle. The former is selected as the higher antenna in the communication
link. Regarding the latter, the “settled field distance” is used for select the proper model;
its value is given by</p>
<div class="math notranslate nohighlight">
\[d_{s} = \frac{\lambda d^2}{\Delta h_{b}^2}\]</div>
<p>with</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\Delta h_b = h_b - h_m\)</span></p>
</div></blockquote>
<p>Therefore, in case of <span class="math notranslate nohighlight">\(l &gt; d_s\)</span> (where <cite>l</cite> is the distance over which the building extend),
it can be evaluated according to</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}L_{msd} = L_{bsh} + k_{a} + k_{d}\log{(d/1000)} + k_{f}\log{(f)} - 9\log{(b)}\\\begin{split}L_{bsh} = \left\{ \begin{array}{ll} -18\log{(1+\Delta h_{b})} &amp; \mbox{for } h_{b} &gt; h_{r} \\ 0 &amp; \mbox{for } h_{b} \le h_{hr} \end{array}\right.\end{split}\\\begin{split}k_a = \left\{ \begin{array}{lll}
    71.4 &amp; \mbox{for } h_{b} &gt; h_{r} \mbox{ and } f&gt;2000 \mbox{ MHz} \\
    54 &amp; \mbox{for } h_{b} &gt; h_{r} \mbox{ and } f\le2000 \mbox{ MHz} \\
    54-0.8\Delta h_b &amp; \mbox{for } h_{b} \le h_{r} \mbox{ and } d \ge 500 \mbox{ m} \\
    54-1.6\Delta h_b &amp; \mbox{for } h_{b} \le h_{r} \mbox{ and } d &lt; 500 \mbox{ m} \\
    \end{array} \right.\end{split}\\\begin{split}k_d = \left\{ \begin{array}{ll}
      18 &amp; \mbox{for } h_{b} &gt; h_{r} \\
      18 -15\frac{\Delta h_b}{h_r} &amp; \mbox{for } h_{b} \le h_{r}
      \end{array} \right.\end{split}\\\begin{split}k_f = \left\{ \begin{array}{ll}
      -8 &amp; \mbox{for } f&gt;2000 \mbox{ MHz} \\
      -4 + 0.7(f/925 -1) &amp; \mbox{for medium city and suburban centres and} f\le2000 \mbox{ MHz} \\
      -4 + 1.5(f/925 -1) &amp; \mbox{for metropolitan centres and } f\le2000 \mbox{ MHz}
      \end{array}\right.\end{split}\end{aligned}\end{align} \]</div>
<p>Alternatively, in case of <span class="math notranslate nohighlight">\(l &lt; d_s\)</span>, the formula is:</p>
<div class="math notranslate nohighlight">
\[L_{msd} = -10\log{\left(Q_M^2\right)}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}Q_M = \left\{ \begin{array}{lll}
      2.35\left(\frac{\Delta h_b}{d}\sqrt{\frac{b}{\lambda}}\right)^{0.9} &amp; \mbox{for } h_{b} &gt; h_{r} \\
      \frac{b}{d} &amp;  \mbox{for } h_{b} \approx h_{r} \\
      \frac{b}{2\pi d}\sqrt{\frac{\lambda}{\rho}}\left(\frac{1}{\theta}-\frac{1}{2\pi + \theta}\right) &amp; \mbox{for }  h_{b} &lt; h_{r}
      \end{array}\right.\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\theta = arc tan \left(\frac{\Delta h_b}{b}\right)\\\rho = \sqrt{\Delta h_b^2 + b^2}\end{aligned}\end{align} \]</div>
</section>
<section id="kun2600mhzpropagationlossmodel">
<h3>Kun2600MhzPropagationLossModel<a class="headerlink" href="#kun2600mhzpropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>This is the empirical model for the pathloss at 2600 MHz for urban areas which is described in <a class="reference internal" href="#kun2600mhz" id="id8"><span>[kun2600mhz]</span></a>.
The model is as follows. Let <span class="math notranslate nohighlight">\(d\)</span> be the distance between the transmitter and the receiver
in meters; the pathloss <span class="math notranslate nohighlight">\(L\)</span> in dB is calculated as:</p>
<div class="math notranslate nohighlight">
\[L = 36 + 26\log{d}\]</div>
</section>
<section id="threegpppropagationlossmodel">
<h3>ThreeGppPropagationLossModel<a class="headerlink" href="#threegpppropagationlossmodel" title="Link to this heading">¶</a></h3>
<p>The base class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModel</span></code> and its derived classes implement
the path loss and shadow fading models described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>.
3GPP TR 38.901 includes multiple scenarios modeling different propagation
environments, i.e., indoor, outdoor urban and rural, for frequencies between
0.5 and 100 GHz.</p>
<p><em>Implemented features:</em></p>
<blockquote>
<div><ul class="simple">
<li><p>Path loss and shadowing models (3GPP TR 38.901, Sec. 7.4.1)</p></li>
<li><p>Autocorrelation of shadow fading (3GPP TR 38.901, Sec. 7.4.4)</p></li>
<li><p><a class="reference external" href="propagation.html#threegppchannelconditionmodel">Channel condition models</a> (3GPP TR 38.901, Sec. 7.4.2)</p></li>
<li><p>O2I Low/High Building penetration losses (3GPP TR 38.901, Sec. 7.4.3.1).
The Low/High Building penetration losses can be enabled for UEs that are in
O2I channel condition state.
For determining the O2O/O2I state in ns-3 there are two possible scenario setups:
1) ns-3 buildings and <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BuildingsChannelConditionModel</span></code> are used.
Then the O2I condition is calculated based on the buildings in the scenario.
In this case losses are considered by default, however there is the option
to disable them by setting the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModel</span></code>
attribute BuildingPenetrationLossesEnabled to false.
2) ns-3 buildings are not used, instead one of the 3GPP stochastic channel condition
models is used, such as: <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppRmaChannelConditionModel</span></code>,
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppUmaChannelConditionModel</span></code>, <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppUmiStreetCanyonChannelConditionModel</span></code>.
These models are extended to calculate the O2O/O2I state probabilistically.
Additionally, it is possible to configure to calculate O2I condition
deterministically based on the UE height. In both cases, the O2O/O2I is updated
at the same time as LOS/nLOS, i.e. with the same periodicity.
For other 3GPP channel condition models in ns-3 there are no O2I losses because
both TX and RX, are either indoor or outdoor, such as in the case of indoor or
V2V scenarios.
For this case, to consider O2I Low/High Losses, the attribute of the
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelCondition</span></code> O2iThreshold (that indicates the ratio between
O2O and O2I states) must be set to a value different from 0. Possible values
are from 0 to 1, with 1 corresponding to 100% O2I conditions.</p></li>
</ul>
</div></blockquote>
<p><em>To be implemented:</em></p>
<blockquote>
<div><ul class="simple">
<li><p>O2I Car penetration losses (3GPP TR 38.901, Sec. 7.4.3.2).</p></li>
<li><p>Spatial consistent update of the channel states (3GPP TR 38.901 Sec. 7.6.3.3)</p></li>
</ul>
</div></blockquote>
<p><strong>Configuration</strong></p>
<p>The <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModel</span></code> instance is paired with a <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelConditionModel</span></code>
instance used to retrieve the LOS/NLOS channel condition. By default, a 3GPP
channel condition model related to the same scenario is set (e.g., by default,
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppRmaPropagationLossModel</span></code> is paired with
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppRmaChannelConditionModel</span></code>), but it can be configured using
the method SetChannelConditionModel. The channel condition models are stored inside the
<code class="docutils literal notranslate"><span class="pre">propagation</span></code> module, for a limitation of the current spectrum API and to avoid
a circular dependency between the spectrum and the <code class="docutils literal notranslate"><span class="pre">propagation</span></code> modules. Please
note that it is necessary to install at least one <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelConditionModel</span></code> when
using any <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModel</span></code> subclass. Please look below for more
information about the Channel Condition models.</p>
<p>The operating frequency has to be set using the attribute “Frequency”,
otherwise an assert is raised. The addition of the shadow fading component can
be enabled/disabled through the attribute “ShadowingEnabled”.
Other scenario-related parameters can be configured through attributes of the
derived classes.</p>
<p>One other attribute, “EnforceParameterRanges”, can be set to true if the
model is configured with parameters that fall outside of the applicability
range specified in TR38.901.  By default, the simulator will only warn
(if logging is enabled) if a value is outside of the applicability range.
If this parameter is set to true, the simulation will abort with an
error message (instead of just logging a warning) if the applicability range
is exceeded.</p>
<p><strong>Implementation details</strong></p>
<p>The method DoCalcRxPower computes the propagation loss considering the path loss
and the shadow fading (if enabled). The path loss is computed by the method
GetLossLos or GetLossNlos depending on the LOS/NLOS channel condition, and their
implementation is left to the derived classes. The shadow fading is computed by
the method GetShadowing, which generates an additional random loss component
characterized by Gaussian distribution with zero mean and scenario-specific
standard deviation. Subsequent shadowing components of each BS-UT link are
correlated as described in 3GPP TR 38.901, Sec. 7.4.4 <a class="footnote-reference brackets" href="#id29" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>.</p>
<p><em>Note 1</em>: The TR defines height ranges for UTs and BSs, depending on the chosen
propagation model (for the exact values, please see below in the specific model
documentation). If the user does not set correct values, the model will emit
a warning but perform the calculation anyway.</p>
<p><em>Note 2</em>: The 3GPP model is originally intended to be used to represent BS-UT
links. However, in ns-3, we may need to compute the pathloss between two BSs
or UTs to evaluate the interference. We have decided to support this case by
considering the tallest node as a BS and the smallest as a UT. As a consequence,
the height values may be outside the validity range of the chosen class:
therefore, an inaccuracy warning may be printed, but it can be ignored.</p>
<p>There are four derived class, each one implementing the propagation model for a different scenario:</p>
<section id="threegpprmapropagationlossmodel">
<h4>ThreeGppRMaPropagationLossModel<a class="headerlink" href="#threegpprmapropagationlossmodel" title="Link to this heading">¶</a></h4>
<p>This class implements the LOS/NLOS path loss and shadow fading models described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.1-1 for the RMa scenario.
It supports frequencies between 0.5 and 30 GHz.
It is possible to configure some scenario-related parameters through the attributes AvgBuildingHeight and AvgStreetWidth.</p>
<p>As specified in the TR, the 2D distance between the transmitter and the receiver
should be between 10 m and 10 km for the LOS case, or between 10 m and 5 km for
the NLOS case, otherwise the model may not be accurate (a warning message is
printed if the user has enabled logging on the model, or the simulation aborts, depending on whether “EnforceParameterRanges” is set to true). Also, the height of the
base station (hBS) should be between 10 m and 150 m, while the height of the
user terminal (hUT) should be between 1 m and 10 m.</p>
</section>
<section id="threegppumapropagationlossmodel">
<h4>ThreeGppUMaPropagationLossModel<a class="headerlink" href="#threegppumapropagationlossmodel" title="Link to this heading">¶</a></h4>
<p>This implements the LOS/NLOS path loss and shadow fading models described in 3GPP
TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.1-1 for the UMa scenario. It supports frequencies
between 0.5 and 100 GHz.</p>
<p>As specified in the TR, the 2D distance between the transmitter and the receiver
should be between 10 m and 5 km both for the LOS and NLOS cases, otherwise the model may not be
accurate (a warning message is printed if the user has enabled logging on the model, or the simulation aborts, depending on whether “EnforceParameterRanges” is set to true).
Also, the height of the base station (hBS) should be 25 m and the height of the
user terminal (hUT) should be between 1.5 m and 22.5 m.</p>
</section>
<section id="threegppumistreetcanyonpropagationlossmodel">
<h4>ThreeGppUmiStreetCanyonPropagationLossModel<a class="headerlink" href="#threegppumistreetcanyonpropagationlossmodel" title="Link to this heading">¶</a></h4>
<p>This implements the LOS/NLOS path loss and shadow fading models described in 3GPP
TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.1-1 for the UMi-Street Canyon scenario. It
supports frequencies between 0.5 and 100 GHz.</p>
<p>As specified in the TR, the 2D distance between the transmitter and the receiver
should be between 10 m and 5 km both for the LOS and NLOS cases, otherwise the model may not be
accurate (a warning message is printed if the user has enabled logging on
the model, or the simulation aborts, depending on whether “EnforceParameterRanges” is set to true). Also, the height of the base station (hBS) should be 10 m and the
height of the user terminal (hUT) should be between 1.5 m and 10 m (the validity
range is reduced because we assume that the height of the UT nodes is always
lower that the height of the BS nodes).</p>
</section>
<section id="threegppindoorofficepropagationlossmodel">
<h4>ThreeGppIndoorOfficePropagationLossModel<a class="headerlink" href="#threegppindoorofficepropagationlossmodel" title="Link to this heading">¶</a></h4>
<p>This implements the LOS/NLOS path loss and shadow fading models described in 3GPP
TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.1-1 for the Indoor-Office scenario. It supports
frequencies between 0.5 and 100 GHz.</p>
<p>As specified in the TR, the 3D distance between the transmitter and the receiver
should be between 1 m and 150 m both for the LOS and NLOS cases, otherwise the
model may not be accurate (a warning log message is printed if the user has
enabled logging on the model, or the simulation aborts, depending on whether “EnforceParameterRanges” is set to true).</p>
</section>
<section id="testing">
<h4>Testing<a class="headerlink" href="#testing" title="Link to this heading">¶</a></h4>
<p>The test suite <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModelsTestSuite</span></code> provides test cases for the classes
implementing the 3GPP propagation loss models.
The test cases <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppRmaPropagationLossModelTestCase</span></code>,
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppUmaPropagationLossModelTestCase</span></code>,
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppUmiPropagationLossModelTestCase</span></code> and
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppIndoorOfficePropagationLossModelTestCase</span></code> compute the path loss between two nodes and compares it with the value obtained using the formulas in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.1-1.
The test case <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppShadowingTestCase</span></code> checks if the shadowing is correctly computed by testing the deviation of the overall propagation loss from the path loss. The test is carried out for all the scenarios, both in LOS and NLOS condition.</p>
</section>
</section>
</section>
<section id="channelconditionmodel">
<h2>ChannelConditionModel<a class="headerlink" href="#channelconditionmodel" title="Link to this heading">¶</a></h2>
<p>The loss models require to know if two nodes are in Line-of-Sight (LoS) or if
they are not. The interface for that is represented by this class. The main
method is GetChannelCondition (a, b), which returns a <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelCondition</span></code> object
containing the information about the channel state.</p>
<p>We modeled the LoS condition in two ways: (i) by using a probabilistic model
specified by the 3GPP (), and (ii) by using an ns-3 specific
building-aware model, which checks the space position of the BSs and the UTs.
For what regards the first option, the probability is independent of the node
location: in other words, following the 3GPP model, two UT spatially separated
by an epsilon may have different LoS conditions. To take into account mobility,
we have inserted a parameter called “UpdatePeriod,” which indicates how often a
3GPP-based channel condition has to be updated. By default, this attribute is
set to 0, meaning that after the channel condition is generated, it is never
updated. With this default value, we encourage the users to run multiple
simulations with different seeds to get statistical significance from the data.
For the users interested in using mobile nodes, we suggest changing this
parameter to a value that takes into account the node speed and the desired
accuracy. For example, lower-speed node conditions may be updated in terms of
seconds, while high-speed UT or BS may be updated more often.</p>
<p>The two approach are coded, respectively, in the classes:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppChannelConditionModel</span></code></p></li>
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BuildingsChannelConditionModel</span></code> (see the <code class="docutils literal notranslate"><span class="pre">building</span></code> module documentation for further details)</p></li>
</ul>
<section id="threegppchannelconditionmodel">
<h3>ThreeGppChannelConditionModel<a class="headerlink" href="#threegppchannelconditionmodel" title="Link to this heading">¶</a></h3>
<p>This is the base class for the 3GPP channel condition models.
It provides the possibility to updated the condition of each channel periodically,
after a given time period which can be configured through the attribute “UpdatePeriod”.
If “UpdatePeriod” is set to 0, the channel condition is never updated.
It has five derived classes implementing the channel condition models described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id16" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a> for different propagation scenarios.</p>
<section id="threegpprmachannelconditionmodel">
<h4>ThreeGppRmaChannelConditionModel<a class="headerlink" href="#threegpprmachannelconditionmodel" title="Link to this heading">¶</a></h4>
<p>This implements the statistical channel condition model described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.2-1, for the RMa scenario.</p>
</section>
<section id="threegppumachannelconditionmodel">
<h4>ThreeGppUmaChannelConditionModel<a class="headerlink" href="#threegppumachannelconditionmodel" title="Link to this heading">¶</a></h4>
<p>This implements the statistical channel condition model described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.2-1, for the UMa scenario.</p>
</section>
<section id="threegppumistreetcanyonchannelconditionmodel">
<h4>ThreeGppUmiStreetCanyonChannelConditionModel<a class="headerlink" href="#threegppumistreetcanyonchannelconditionmodel" title="Link to this heading">¶</a></h4>
<p>This implements the statistical channel condition model described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.2-1, for the UMi-Street Canyon scenario.</p>
</section>
<section id="threegppindoormixedofficechannelconditionmodel">
<h4>ThreeGppIndoorMixedOfficeChannelConditionModel<a class="headerlink" href="#threegppindoormixedofficechannelconditionmodel" title="Link to this heading">¶</a></h4>
<p>This implements the statistical channel condition model described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id20" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.2-1, for the Indoor-Mixed office scenario.</p>
</section>
<section id="threegppindooropenofficechannelconditionmodel">
<h4>ThreeGppIndoorOpenOfficeChannelConditionModel<a class="headerlink" href="#threegppindooropenofficechannelconditionmodel" title="Link to this heading">¶</a></h4>
<p>This implements the statistical channel condition model described in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.2-1, for the Indoor-Open office scenario.</p>
</section>
</section>
<section id="id22">
<h3>Testing<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<p>The test suite <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelConditionModelsTestSuite</span></code> contains a single test case:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppChannelConditionModelTestCase</span></code>, which tests all the 3GPP channel condition models. It determines the channel condition between two nodes multiple times, estimates the LOS probability, and compares it with the value given by the formulas in 3GPP TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id23" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a>, Table 7.4.2-1</p></li>
</ul>
</section>
</section>
<section id="propagationdelaymodel">
<h2>PropagationDelayModel<a class="headerlink" href="#propagationdelaymodel" title="Link to this heading">¶</a></h2>
<p>The following propagation delay models are implemented:</p>
<ul class="simple">
<li><p>ConstantSpeedPropagationDelayModel</p></li>
<li><p>RandomPropagationDelayModel</p></li>
</ul>
<section id="constantspeedpropagationdelaymodel">
<h3>ConstantSpeedPropagationDelayModel<a class="headerlink" href="#constantspeedpropagationdelaymodel" title="Link to this heading">¶</a></h3>
<p>In this model, the signal travels with constant speed.
The delay is calculated according with the transmitter and receiver positions.
The Euclidean distance between the Tx and Rx antennas is used.
Beware that, according to this model, the Earth is flat.</p>
</section>
<section id="randompropagationdelaymodel">
<h3>RandomPropagationDelayModel<a class="headerlink" href="#randompropagationdelaymodel" title="Link to this heading">¶</a></h3>
<p>The propagation delay is totally random, and it changes each time the model is called.
All the packets (even those between two fixed nodes) experience a random delay.
As a consequence, the packets order is not preserved.</p>
</section>
</section>
<section id="models-for-vehicular-environments">
<h2>Models for vehicular environments<a class="headerlink" href="#models-for-vehicular-environments" title="Link to this heading">¶</a></h2>
<p>The 3GPP TR 37.885 <a class="footnote-reference brackets" href="#id30" id="id24" role="doc-noteref"><span class="fn-bracket">[</span>37885<span class="fn-bracket">]</span></a> specifications extends the channel modeling framework
described in TR 38.901 <a class="footnote-reference brackets" href="#id29" id="id25" role="doc-noteref"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></a> to simulate wireless channels in vehicular environments.
The extended framework supports frequencies between 0.5 to 100 GHz and provides
the possibility to simulate urban and highway propagation environments.
To do so, new propagation loss and channel condition models, as well as new
parameters for the fast fading model, are provided.</p>
<section id="vehicular-channel-condition-models">
<span id="sec-3gpp-v2v-ch-cond"></span><h3>Vehicular channel condition models<a class="headerlink" href="#vehicular-channel-condition-models" title="Link to this heading">¶</a></h3>
<p>To properly capture channel dynamics in vehicular environments, three different
channel conditions have been identified:</p>
<blockquote>
<div><ul class="simple">
<li><p>LOS (Line Of Sight): represents the case in which the direct path between
the transmitter and the receiver is not blocked</p></li>
<li><p>NLOSv (Non Line Of Sight vehicle): when the direct path
between the transmitter and the receiver is blocked by a vehicle</p></li>
<li><p>NLOS (Non Line Of Sight): when the direct path is blocked by a building</p></li>
</ul>
</div></blockquote>
<p>TR 37.885 includes two models that can be used to determine the condition of
the wireless channel between a pair of nodes, the first for urban and the second
for highway environments.
Each model includes both a deterministic and a stochastic part, and works as
follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The model determines the presence of buildings obstructing the direct path
between the communicating nodes. This is done in a deterministic way, looking at
the possible interceptions between the direct path and the buildings.
If the path is obstructed, the channel condition is set to NLOS.</p></li>
<li><p>If not, the model determines the presence of vehicles obstructing the
direct path. This is done using a probabilistic model, which is specific
for the scenario of interest. If the path is obstructed, the channel
condition is set to NLOSv, otherwise is set to LOS.</p></li>
</ol>
</div></blockquote>
<p>These models have been implemented by extending the interface
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelConditionModel</span></code> with the following classes. They have been included in
the <code class="docutils literal notranslate"><span class="pre">building</span></code> module, because they make use of <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Buildings</span></code> objects to determine
the presence of obstructions caused by buildings.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppV2vUrbanChannelConditionModel</span></code>: implements the model
described in Table 6.2-1 of TR 37.885 for the urban scenario.</p></li>
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppV2vHighwayChannelConditionModel</span></code>: implements the model
described in Table 6.2-1 of TR 37.885 for the highway scenario.</p></li>
</ul>
</div></blockquote>
<p>These models rely on <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Buildings</span></code> objects to determine the presence
of obstructing buildings. When considering large scenarios with a large number of
buildings, this process may become computationally demanding and dramatically
increase the simulation time.
To solve this problem, we implemented two fully-probabilistic models
that can be used as an alternative to the ones included in TR 37.885.
These models are based on the work carried out by M. Boban et al. <a class="reference internal" href="#boban2016modeling" id="id26"><span>[Boban2016Modeling]</span></a>,
which derived a statistical representation of the three channel conditions,
With the fully-probabilistic models there is no need to determine the presence of blocking
buildings in a deterministic way, and therefore the computational effort is
reduced.
To determine the channel condition, these models account for the propagation
environment, i.e., urban or highway, as well as for the density of vehicles in the
scenario, which can be high, medium, or low.</p>
<p>The classes implementing the fully-probabilistic models are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ProbabilisticV2vUrbanChannelConditionModel</span></code>: implements the model
described in <a class="reference internal" href="#boban2016modeling" id="id27"><span>[Boban2016Modeling]</span></a> for the urban scenario.</p></li>
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ProbabilisticV2vHighwayChannelConditionModel</span></code>: implements the model
described in <a class="reference internal" href="#boban2016modeling" id="id28"><span>[Boban2016Modeling]</span></a> for the highway scenario.</p></li>
</ul>
</div></blockquote>
<p>Both the classes own the attribute “Density”, which can be used to select the
proper value depending on the scenario that have to be simulated.
Differently from the hybrid models described above, these classes have been
included in the <code class="docutils literal notranslate"><span class="pre">propagation</span></code> module, since they do not have any dependency on the
<code class="docutils literal notranslate"><span class="pre">building</span></code> module.</p>
<p><strong>NOTE:</strong> Both the hybrid and the fully-probabilistic models supports the
modeling of outdoor scenarios, no support is provided for the modeling of
indoor scenarios.</p>
</section>
<section id="vehicular-propagation-loss-models">
<h3>Vehicular propagation loss models<a class="headerlink" href="#vehicular-propagation-loss-models" title="Link to this heading">¶</a></h3>
<p>The propagation models described in TR 37.885 determines the attenuation caused
by path loss and shadowing by considering the propagation environment and the
channel condition.</p>
<p>These models have been implemented by extending the interface
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModel</span></code> with the following classes, which
are part of the <code class="docutils literal notranslate"><span class="pre">propagation</span></code> module:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppV2vUrbanPropagationLossModel</span></code>: implements the models
defined in Table 6.2.1-1 of TR 37.885 for the urban scenario.</p></li>
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppV2vHighwayPropagationLossModel</span></code>: implements the models
defined in Table 6.2.1-1 of TR 37.885 for the highway scenario.</p></li>
</ul>
</div></blockquote>
<p>As for all the classes extending the interface <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppPropagationLossModel</span></code>,
they have to be paired with an instance of the class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelConditionModel</span></code>
which is used to determine the channel condition.
This is done by setting the attribute <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ChannelConditionModel</span></code>.
To build the channel modeling framework described in TR 37.885,
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppV2vUrbanChannelConditionModel</span></code> or
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppV2vHighwayChannelConditionModel</span></code> should be used, but users
are allowed to test any other combination.</p>
</section>
<section id="vehicular-fast-fading-model">
<span id="sec-3gpp-v2v-ff"></span><h3>Vehicular fast fading model<a class="headerlink" href="#vehicular-fast-fading-model" title="Link to this heading">¶</a></h3>
<p>The fast fading model described in Sec. 6.2.3 of TR 37.885 is based on the one
specified in TR 38.901, whose implementation is provided in the <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> module
(see the <a class="reference internal" href="../../spectrum/doc/spectrum.html#gpp-fast-fading-model"><span class="std std-ref">spectrum module documentation</span></a>).
This model is general and includes different parameters which can
be tuned to simulate multiple propagation environments.
To better model the channel dynamics in vehicular environments, TR 37.885
provides new sets of values for these parameters, specific for
vehicle-to-vehicle transmissions in urban and highway scenarios.
To select the parameters for vehicular scenarios, it is necessary to set
the attribute “Scenario” of the class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppChannelModel</span></code> using the value
“V2V-Urban” or “V2V-Highway”.</p>
<p>edditionally, TR 37.885 specifies a new equation to compute the Doppler component,
which accounts for the mobility of both nodes, as well as scattering
from the environment.
In particular, the scattering effect is considered by deviating the Doppler
frequency by a random value, whose distribution depends on the parameter <span class="math notranslate nohighlight">\(v_{scatt}\)</span>.
TR 37.885 specifies that <span class="math notranslate nohighlight">\(v_{scatt}\)</span> should be set to the maximum speed of the
vehicles in the layout and, if <span class="math notranslate nohighlight">\(v_{scatt} = 0\)</span>, the scattering effect is not considered.
The Doppler equation is implemented in the class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ThreeGppSpectrumPropagationLossModel</span></code>.
By means of the attribute “vScatt”, it is possible to adjust the value of
<span class="math notranslate nohighlight">\(v_{scatt} = 0\)</span> (by default, the value is set to 0).</p>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h3>
<p>We implemented the example <code class="docutils literal notranslate"><span class="pre">three-gpp-v2v-channel-example.cc</span></code> which shows how to
configure the different classes to simulate wireless propagation in vehicular
scenarios, it can be found in the folder <code class="docutils literal notranslate"><span class="pre">examples/channel-models</span></code>.</p>
<p>We considered two communicating vehicles moving within the scenario, and
computed the SNR experienced during the entire simulation, with a time
resolution of 10 ms.
The vehicles are equipped with 2x2 antenna arrays modeled using the
<a class="reference internal" href="../../antenna/doc/source/antenna-design.html#gpp-antenna-model"><span class="std std-ref">3GPP antenna model</span></a>.
The bearing and the downtilt angles are properly configured and the
optimal beamforming vectors are computed at the beginning of the simulation.</p>
<p>The simulation script accepts the following command line parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>frequency</em>: the operating frequency in Hz</p></li>
<li><p><em>txPow</em>: the transmission power in dBm</p></li>
<li><p><em>noiseFigure</em>: the noise figure in dB</p></li>
<li><p><em>scenario</em>: the simulation scenario, “V2V-Urban” or “V2V-Highway”</p></li>
</ul>
</div></blockquote>
<p>The “V2V-Urban” scenario simulates urban environment with a rectangular grid of
buildings. The vehicles moves with a waypoint mobility model. They start from
the same position and travel in the same direction, along the main street.
The first vehicle moves at 60 km/h and the second at 30 km/h.
At a certain point, the first vehicle turns left while the second continues on
the main street.</p>
<p>The “V2V-Highway” scenario simulates an highway environment in which the
two vehicles travel on the same lane, in the same direction, and keep a safety
distance of 20 m. They maintain a constant speed of 140 km/h.</p>
<p>The example generates the output file <code class="docutils literal notranslate"><span class="pre">example-output.txt</span></code>. Each row of the
file is organized as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">Time[s]</span> <span class="pre">TxPosX[m]</span> <span class="pre">TxPosY[m]</span> <span class="pre">RxPosX[m]</span> <span class="pre">RxPosY[m]</span> <span class="pre">ChannelState</span> <span class="pre">SNR[dB]</span> <span class="pre">Pathloss[dB]</span></code></p>
<p>We also provide the bash script <code class="docutils literal notranslate"><span class="pre">three-gpp-v2v-channel-example.sh</span></code> which reads the
output file and generates two figures:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>map.gif, a GIF representing the simulation scenario and vehicle mobility;</p></li>
<li><p>snr.png, which represents the behavior of the SNR.</p></li>
</ol>
</div></blockquote>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="friis" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">friis</a><span class="fn-bracket">]</span></span>
<p>Friis, H.T., “A Note on a Simple Transmission Formula,” Proceedings of the IRE , vol.34, no.5, pp.254,256, May 1946</p>
</div>
<div class="citation" id="hata" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">hata</a><span class="fn-bracket">]</span></span>
<p>M.Hata, “Empirical formula for propagation loss in land mobile radio
services”, IEEE Trans. on Vehicular Technology, vol. 29, pp. 317-325, 1980</p>
</div>
<div class="citation" id="cost231" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">cost231</a><span class="fn-bracket">]</span></span>
<p>“Digital Mobile Radio: COST 231 View on the Evolution Towards 3rd Generation Systems”, Commission of the European Communities, L-2920, Luxembourg, 1989</p>
</div>
<div class="citation" id="walfisch" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">walfisch</a><span class="fn-bracket">]</span></span>
<p>J.Walfisch and H.L. Bertoni, “A Theoretical model of UHF propagation in urban environments,” in IEEE Trans. Antennas Propagat., vol.36, 1988, pp.1788- 1796</p>
</div>
<div class="citation" id="ikegami" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">ikegami</a><span class="fn-bracket">]</span></span>
<p>F.Ikegami, T.Takeuchi, and S.Yoshida, “Theoretical prediction of mean field strength for Urban Mobile Radio”, in IEEE Trans. Antennas Propagat., Vol.39, No.3, 1991</p>
</div>
<div class="citation" id="kun2600mhz" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">kun2600mhz</a><span class="fn-bracket">]</span></span>
<p>Sun Kun, Wang Ping, Li Yingze, “Path loss models for suburban scenario at 2.3GHz, 2.6GHz and 3.5GHz”,
in Proc. of the 8th International Symposium on Antennas, Propagation and EM Theory (ISAPE),  Kunming,  China, Nov 2008.</p>
</div>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id29" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>38901<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id9">1</a>,<a role="doc-backlink" href="#id10">2</a>,<a role="doc-backlink" href="#id11">3</a>,<a role="doc-backlink" href="#id12">4</a>,<a role="doc-backlink" href="#id13">5</a>,<a role="doc-backlink" href="#id14">6</a>,<a role="doc-backlink" href="#id15">7</a>,<a role="doc-backlink" href="#id16">8</a>,<a role="doc-backlink" href="#id17">9</a>,<a role="doc-backlink" href="#id18">10</a>,<a role="doc-backlink" href="#id19">11</a>,<a role="doc-backlink" href="#id20">12</a>,<a role="doc-backlink" href="#id21">13</a>,<a role="doc-backlink" href="#id23">14</a>,<a role="doc-backlink" href="#id25">15</a>)</span>
<p>3GPP. 2018. TR 38.901, Study on channel model for frequencies from 0.5 to 100 GHz, V15.0.0. (2018-06).</p>
</aside>
<aside class="footnote brackets" id="id30" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id24">37885</a><span class="fn-bracket">]</span></span>
<p>3GPP. 2019. TR 37.885, Study on evaluation methodology of new Vehicle-to-Everything (V2X) use cases for LTE and NR, V15.3.0. (2019-06).</p>
</aside>
</aside>
<div role="list" class="citation-list">
<div class="citation" id="boban2016modeling" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Boban2016Modeling<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id26">1</a>,<a role="doc-backlink" href="#id27">2</a>,<a role="doc-backlink" href="#id28">3</a>)</span>
<p>M. Boban,  X. Gong, and  W. Xu, “Modeling the evolution
of line-of-sight blockage for V2V channels,” in IEEE 84th Vehicular Technology
Conference (VTC-Fall), 2016.</p>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ns-3</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, vishnu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/src/propagation/doc/propagation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>