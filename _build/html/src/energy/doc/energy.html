<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Energy Framework &#8212; ns-3 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="energy-framework">
<h1>Energy Framework<a class="headerlink" href="#energy-framework" title="Link to this heading">¶</a></h1>
<p>Energy is a key issue for wireless devices, and network researchers
often need to investigate the energy consumption at a node or in the
overall network while running network simulations in <a href="#id13"><span class="problematic" id="id14">|ns3|</span></a>.
This requires <a href="#id15"><span class="problematic" id="id16">|ns3|</span></a> to support an energy framework.
Further, as concepts such as fuel cells and energy
scavenging are becoming viable for low power wireless devices,
incorporating the effect of these emerging technologies into
simulations requires support for modeling diverse energy models in
ns-3. The <a href="#id17"><span class="problematic" id="id18">|ns3|</span></a> energy framework provides the basis for energy storing
consumption and harvesting.</p>
<section id="model-description">
<h2>Model Description<a class="headerlink" href="#model-description" title="Link to this heading">¶</a></h2>
<p>The framework is implemented into the <code class="docutils literal notranslate"><span class="pre">src/energy/</span></code> folder.</p>
<p>The <a href="#id19"><span class="problematic" id="id20">|ns3|</span></a> energy framework is composed of 3 essential parts:</p>
<ul class="simple">
<li><p><strong>Energy source models.</strong> Represent storing energy sources such as batteries or capacitors.</p></li>
<li><p><strong>Energy consumption models.</strong> Represent a portion of a device that draws energy from energy sources. Examples of this include sensors, radio transceivers, vehicles, UAV, etc.</p></li>
<li><p><strong>Energy harvesting models.</strong> Represent devices that provide energy to energy sources. For example, solar panels and chargers.</p></li>
</ul>
<figure class="align-default" id="id7">
<span id="fig-energyframework"></span><img alt="src/energy/doc/figures/energyFramework.*" src="src/energy/doc/figures/energyFramework.*" />
<figcaption>
<p><span class="caption-text"><a href="#id21"><span class="problematic" id="id22">|ns3|</span></a> energy framework</span><a class="headerlink" href="#id7" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="energy-source-models">
<h3>Energy Source Models<a class="headerlink" href="#energy-source-models" title="Link to this heading">¶</a></h3>
<p>An energy source represents a power supply. In <a href="#id23"><span class="problematic" id="id24">|ns3|</span></a>, nodes can
have one or more energy sources. Likewise, energy sources can be
connected to multiple energy consuption models (Device energy models).
Connecting an energy source to a device energy model implies that the
corresponding device draws power from the source.
When energy is completely drained from the energy source, it notifies to the device energy models on
the node such that each device energy model can react to this event. Further, each node
can access the energy source objects for information such as remaining capacity , voltage or
state of charge (SoC). This enables the implementation of energy aware protocols in ns-3.</p>
<p>In order to model a wide range of power supplies such as batteries, the energy source must be able to capture characteristics of these supplies. There are 2 important characteristics or effects related to practical batteries:</p>
<ul class="simple">
<li><p><strong>Rate Capacity Effect.</strong> Decrease of battery lifetime when the current draw is higher than the rated value of the battery.</p></li>
<li><p><strong>Recovery Effect.</strong> Increase of battery lifetime when the battery is alternating between discharge and idle states.</p></li>
</ul>
<p>In order to incorporate the Rate Capacity Effect, the Energy Source
uses current draw from all the devices on the same node to calculate
energy consumption. Moreover, multiple Energy Harvesters can be
connected to the Energy Source in order to replenish its energy. The
Energy Source periodically polls all the devices and energy harvesters
on the same node to calculate the total current drain and hence the
energy consumption. When a device changes state, its corresponding
Device Energy Model will notify the Energy Source of this change and
new total current draw will be calculated. Similarly, every Energy
Harvester update triggers an update to the connected Energy Source.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">EnergySource</span></code> base class keeps a list of devices (<code class="docutils literal notranslate"><span class="pre">DeviceEnergyModel</span></code> objects) and energy harvesters (<code class="docutils literal notranslate"><span class="pre">EnergyHarvester</span></code> objects) that are using the particular Energy Source as power supply. When energy is completely drained, the Energy Source will notify all devices on this list. Each device can then handle this event independently, based on the desired behavior that should be followed in case of power outage.</p>
<section id="generic-batttery-model">
<h4>Generic Batttery Model<a class="headerlink" href="#generic-batttery-model" title="Link to this heading">¶</a></h4>
<p>The Generic battery model is able to represent 4 basic types of batteries
chemestries: Lithium-Ion (LiIon) or Lithium Polymer (LiPo), Nickel Cadmium (NiCd),
Lead Acid, and Nickel-metal hydride (NiMH). The main difference between these batteries
is the shape of the discharge curves when using constant discharge current and that
NiCd and NiMh batteries hysteresis phenomenon is also modeled. Peurket effect, aging,
temperature and variable battery impedance is not considered for all batteries. batteries
with similar discharge behavior might be also represented but one of the 4 basic
arqueotipes must be chosen.</p>
<p>The Generic Battery Model is directly based by the works of Trembley et al.
Tremblay’s model on itself is based on a popular battery model created by Shepherd.
Tremblay’s model consist in visually identify a set of points from batteries manufacters’
discharge curves datasheets.</p>
<figure class="align-default" id="id8">
<span id="id1"></span><img alt="../../../_images/dischargeCurve.png" src="../../../_images/dischargeCurve.png" />
<figcaption>
<p><span class="caption-text"><a href="#id25"><span class="problematic" id="id26">|ns3|</span></a> Generic Battery Model Points in battery discharge curve.</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The 3 basic set of points that require identification in a datasheet are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V_{full}:\)</span> The full battery voltage</p></li>
<li><p><span class="math notranslate nohighlight">\(Q:\)</span> The maximum battery capacity</p></li>
<li><p><span class="math notranslate nohighlight">\(V_{exp}:\)</span> The voltage at the end of the exponential zone</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_{exp}:\)</span> The capacity at the end of the exponential zone</p></li>
<li><p><span class="math notranslate nohighlight">\(V_{nom}:\)</span> The voltage at the end of the exponential zone</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_{nom}:\)</span> The capacity at the end of the exponential zone</p></li>
</ul>
<p>Additionally, it is also necessary to set the values of:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R:\)</span> The battery impedance (The battery internal resistance)</p></li>
<li><p><span class="math notranslate nohighlight">\(i_{typical}:\)</span> The typical current value used to discharge the battery, this value is used to calculate some of the constants used in the model.</p></li>
<li><p><span class="math notranslate nohighlight">\(cutoffVoltage:\)</span> Required if we desired to inform connected energy consumption models that the battery has reached its discharged point.</p></li>
<li><p><span class="math notranslate nohighlight">\(i:\)</span> The discharge current used to discharge the battery. This value is provided by the energy consumption model attached to the battery.</p></li>
</ul>
<p>The value of <span class="math notranslate nohighlight">\(R\)</span> is typically included in the datatsheets, however, because <span class="math notranslate nohighlight">\(R\)</span> variability is not modeled in <a href="#id27"><span class="problematic" id="id28">|ns3|</span></a> (The resistance is fixed), it is necessary
to discretely adjust its value to obtain the desired discharge curves. The value <span class="math notranslate nohighlight">\(i_{typical}\)</span> can
be obtained by inferring its value from the discharged curves shown in datasheets. When modeling
the behavior of a new battery, it is important to chose values that satisfies more than one curve,
trial an error adjustments might be necessary to obtain the desired results.</p>
<p>Attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FullVoltage</span></code>: Represents the <span class="math notranslate nohighlight">\(V_{full}\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MaxCapacity</span></code>: Represents the <span class="math notranslate nohighlight">\(Q\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExponentialVoltage</span></code>: Represents the <span class="math notranslate nohighlight">\(V_{exp}\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExponentialCapacity</span></code>: Represents the <span class="math notranslate nohighlight">\(Q_{exp}\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NominalVoltage</span></code>: Represents the <span class="math notranslate nohighlight">\(V_{nom}\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NominalCapacity</span></code>: Represents the <span class="math notranslate nohighlight">\(Q_{nom}\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">InternalResistance</span></code>: Represents the <span class="math notranslate nohighlight">\(R\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TypicalDischargeCurrent</span></code>: Represents the <span class="math notranslate nohighlight">\(i_{typical}\)</span> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CutoffVoltage</span></code>: The voltage where the battery is considered depleted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BatteryType</span></code>: Indicates the battery type used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PeriodicEnergyUpdateInterval</span></code>: Indicates how often the update values are obtained.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LowBatteryThreshold</span></code>: Additional voltage threshold to indicate when the battery has low energy.</p></li>
</ul>
<p>The process described above can be simplified by installing batteries presents of previously tested
batteries using helpers. Details on helpers usage are detailed in the following sections.</p>
</section>
<section id="rv-battery-model">
<h4>RV Battery Model<a class="headerlink" href="#rv-battery-model" title="Link to this heading">¶</a></h4>
<p>Attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelPeriodicEnergyUpdateInterval</span></code>: RV battery model sampling
interval.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelOpenCircuitVoltage</span></code>: RV battery model open circuit voltage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelCutoffVoltage</span></code>: RV battery model cutoff voltage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelAlphaValue</span></code>: RV battery model alpha value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelBetaValue</span></code>: RV battery model beta value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelNumOfTerms</span></code>: The number of terms of the infinite sum for estimating battery level.</p></li>
</ul>
</section>
<section id="basic-energy-source">
<h4>Basic Energy Source<a class="headerlink" href="#basic-energy-source" title="Link to this heading">¶</a></h4>
<p>Attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BasicEnergySourceInitialEnergyJ</span></code>: Initial energy stored in
basic energy source.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BasicEnergySupplyVoltageV</span></code>: Initial supply voltage for basic energy source.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PeriodicEnergyUpdateInterval</span></code>: Time between two consecutive periodic energy updates.</p></li>
</ul>
</section>
</section>
<section id="energy-consumption-models">
<h3>Energy Consumption Models<a class="headerlink" href="#energy-consumption-models" title="Link to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">DeviceEnergyModel</span></code> is the energy consumption model of a device installed on the node.
It is designed to be a state based model where each device is assumed to have a number of states, and each state is associated with a power consumption value.
Whenever the state of the device changes, the corresponding <code class="docutils literal notranslate"><span class="pre">DeviceEnergyModel</span></code> will notify the associated <code class="docutils literal notranslate"><span class="pre">EnergySourceModel</span></code> of the new current draw of the device.
The <code class="docutils literal notranslate"><span class="pre">EnergySourceModel</span></code> will then calculate the new total current draw and update the remaining energy. A <code class="docutils literal notranslate"><span class="pre">DeviceEnergyModel</span></code> can also be used for devices that do not have finite number of states.
For example, in an electric vehicle, the current draw of the motor is determined by its speed.
Since the vehicle’s speed can take continuous values within a certain range, it is infeasible to define a set of discrete states of operation.
However, by converting the speed value into current draw directly, the same set of <code class="docutils literal notranslate"><span class="pre">DeviceEnergyModel</span></code> APIs can still be used.</p>
<section id="wifi-radio-energy-model">
<h4>WiFi Radio Energy Model<a class="headerlink" href="#wifi-radio-energy-model" title="Link to this heading">¶</a></h4>
<p>The WiFi Radio Energy Model is the energy consumption model of a Wifi
net device. It provides a state for each of the available states of
the PHY layer: Idle, CcaBusy, Tx, Rx, ChannelSwitch, Sleep, Off. Each of
such states is associated with a value (in Ampere) of the current draw
(see below for the corresponding attribute names). A Wifi Radio Energy
Model PHY Listener is registered to the Wifi PHY in order to be
notified of every Wifi PHY state transition. At every transition, the
energy consumed in the previous state is computed and the energy
source is notified in order to update its remaining energy.</p>
<p>The Wifi Tx Current Model gives the possibility to compute the current
draw in the transmit state as a function of the nominal tx power (in
dBm), as observed in several experimental measurements. To this
purpose, the Wifi Radio Energy Model PHY Listener is notified of the
nominal tx power used to transmit the current frame and passes such a
value to the Wifi Tx Current Model which takes care of updating the
current draw in the Tx state. Hence, the energy consumption is
correctly computed even if the Wifi Remote Station Manager performs
per-frame power control. Currently, a Linear Wifi Tx Current Model is
implemented which computes the tx current as a linear function
(according to parameters that can be specified by the user) of the
nominal tx power in dBm.</p>
<p>The Wifi Radio Energy Model offers the possibility to specify a
callback that is invoked when the energy source is depleted. If such a
callback is not specified when the Wifi Radio Energy Model Helper is
used to install the model on a device, a callback is implicitly made
so that the Wifi PHY is put in the OFF mode (hence no frame is
transmitted nor received afterwards) when the energy source is
depleted. Likewise, it is possible to specify a callback that is
invoked when the energy source is recharged (which might occur in case
an energy harvester is connected to the energy source). If such a
callback is not specified when the Wifi Radio Energy Model Helper is
used to install the model on a device, a callback is implicitly made
so that the Wifi PHY is resumed from the OFF mode when the energy
source is recharged.</p>
<p>Attributes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IdleCurrentA</span></code>: The default radio Idle current in Ampere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CcaBusyCurrentA</span></code>: The default radio CCA Busy State current in Ampere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TxCurrentA</span></code>: The radio Tx current in Ampere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RxCurrentA</span></code>: The radio Rx current in Ampere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SwitchingCurrentA</span></code>: The default radio Channel Switch current in Ampere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SleepCurrentA</span></code>: The radio Sleep current in Ampere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TxCurrentModel</span></code>: A pointer to the attached tx current model.</p></li>
</ul>
</section>
</section>
<section id="energy-harvesting-models">
<h3>Energy Harvesting Models<a class="headerlink" href="#energy-harvesting-models" title="Link to this heading">¶</a></h3>
<p>The energy harvester represents the elements that supply energy from
the environment and recharge an energy source to which it is
connected. The energy harvester includes the complete implementation
of the actual energy harvesting device (e.g., a solar panel) and the
environment (e.g., the solar radiation). This means that in
implementing an energy harvester, the energy contribution of the
environment and the additional energy requirements of the energy
harvesting device such as the conversion efficiency and the internal
power consumption of the device needs to be jointly modeled.</p>
</section>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>The main way that ns-3 users will typically interact with the Energy
Framework is through the helper API and through the publicly visible
attributes of the framework. The helper API is defined in
<code class="docutils literal notranslate"><span class="pre">src/energy/helper/*.h</span></code>.</p>
<p>In order to use the energy framework, the user must install an Energy
Source for the node of interest, the corresponding Device Energy Model
for the network devices and, if necessary, the one or more Energy
Harvester. Energy Source (objects) are aggregated onto each node by
the Energy Source Helper. In order to allow multiple energy sources
per node, we aggregate an Energy Source Container rather than directly
aggregating a source object.</p>
<p>The Energy Source object keeps a list of Device Energy Model and
Energy Harvester objects using the source as power supply. Device
Energy Model objects are installed onto the Energy Source by the
Device Energy Model Helper, while Energy Harvester object are
installed by the Energy Harvester Helper. User can access the Device
Energy Model objects through the Energy Source object to obtain energy
consumption information of individual devices. Moreover, the user can
access to the Energy Harvester objects in order to gather information
regarding the current harvestable power and the total energy harvested
by the harvester.</p>
<section id="helpers">
<h3>Helpers<a class="headerlink" href="#helpers" title="Link to this heading">¶</a></h3>
<p><strong>Energy Source Helper:</strong></p>
<p>Base helper class for Energy Source objects, this helper Aggregates
Energy Source object onto a node. Child implementation of this class
creates the actual Energy Source object.</p>
<p><strong>Device Energy Model Helper:</strong></p>
<p>Base helper class for Device Energy Model objects, this helper
attaches Device Energy Model objects onto Energy Source objects. Child
implementation of this class creates the actual Device Energy Model
object.</p>
<p><strong>Energy Harvesting Helper:</strong></p>
<p>Base helper class for Energy Harvester objects, this helper attaches
Energy Harvester objects onto Energy Source objects. Child
implementation of this class creates the actual Energy Harvester
object.</p>
<p><strong>Generic Battery Model Helper:</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">GenericBatteryModelHelper</span></code> can be used to easily install an energy source into a
node or node container of one of four types of chemestries (Li-Ion,Lead Acid, NiCd,NiMH).
Users must use one of the available presets that represent an specific battery.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">GenericBatteryModelHelper</span><span class="w"> </span><span class="n">batteryHelper</span><span class="p">;</span>
<span class="n">EnergySourceContainer</span>
<span class="n">energySourceContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batteryHelper</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodeContainer</span><span class="p">,</span>
<span class="w">                                              </span><span class="n">PANASONIC_CGR18650DA_LION</span><span class="p">);</span>
<span class="n">batteryHelper</span><span class="p">.</span><span class="n">SetCellPack</span><span class="p">(</span><span class="n">energySourceContainer</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>In the previous example, the <code class="docutils literal notranslate"><span class="pre">GenericBatteryModelHelper</span></code> was used to install a Panasonic CGR18650DA
Li-Ion battery. Likewise, the helper is used to define a cell pack of 4 batteries. 2 batteries
connected in series and 2 connected in parallel (2S,2P).</p>
<p>Another option is to manually configure the values that makes the preset:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">();</span>
<span class="k">auto</span><span class="w"> </span><span class="n">devicesEnergyModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">SimpleDeviceEnergyModel</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">batteryModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">GenericBatteryModel</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;FullVoltage&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">1.39</span><span class="p">));</span><span class="w">            </span><span class="c1">// Qfull</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;MaxCapacity&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">7.0</span><span class="p">));</span><span class="w">             </span><span class="c1">// Q</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;NominalVoltage&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">1.18</span><span class="p">));</span><span class="w">         </span><span class="c1">// Vnom</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;NominalCapacity&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">6.25</span><span class="p">));</span><span class="w">        </span><span class="c1">// QNom</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;ExponentialVoltage&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">1.28</span><span class="p">));</span><span class="w">     </span><span class="c1">// Vexp</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;ExponentialCapacity&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">1.3</span><span class="p">));</span><span class="w">     </span><span class="c1">// Qexp</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;InternalResistance&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">0.0046</span><span class="p">));</span><span class="w">   </span><span class="c1">// R</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;TypicalDischargeCurrent&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">1.3</span><span class="p">));</span><span class="w"> </span><span class="c1">// i typical</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;CutoffVoltage&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DoubleValue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">));</span><span class="w">           </span><span class="c1">// End of charge.</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">&quot;BatteryType&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">EnumValue</span><span class="p">(</span><span class="n">NIMH_NICD</span><span class="p">));</span><span class="w">         </span><span class="c1">// General battery type</span>
<span class="n">batteryModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DynamicCast</span><span class="o">&lt;</span><span class="n">GenericBatteryModel</span><span class="o">&gt;</span>
<span class="w">               </span><span class="p">(</span><span class="n">batteryHelper</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">PANASONIC_HHR650D_NIMH</span><span class="p">));</span>
<span class="n">devicesEnergyModel</span><span class="o">-&gt;</span><span class="n">SetEnergySource</span><span class="p">(</span><span class="n">batteryModel</span><span class="p">);</span>
<span class="n">batteryModel</span><span class="o">-&gt;</span><span class="n">AppendDeviceEnergyModel</span><span class="p">(</span><span class="n">devicesEnergyModel</span><span class="p">);</span>
<span class="n">devicesEnergyModel</span><span class="o">-&gt;</span><span class="n">SetNode</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</pre></div>
</div>
<p>Usage of both of these type of configurations are shown in <code class="docutils literal notranslate"><span class="pre">generic-battery-discharge-example.cc</span></code>.
The following table is a list of the available presents in <a href="#id29"><span class="problematic" id="id30">|ns3|</span></a>:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Preset Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PANASONIC_CGR18650DA_LION</p></td>
<td><p>Panasonic Li-Ion  (3.6V, 2450Ah, Size A)</p></td>
</tr>
<tr class="row-odd"><td><p>PANASONIC_HHR650D_NIMH</p></td>
<td><p>Panasonic NiMh HHR550D (1.2V 6.5Ah, Size D)</p></td>
</tr>
<tr class="row-even"><td><p>CSB_GP1272_LEADACID</p></td>
<td><p>CSB Lead Acid GP1272 (12V,7.2Ah)</p></td>
</tr>
<tr class="row-odd"><td><p>PANASONIC_N700AAC_NICD</p></td>
<td><p>Panasonic NiCd N-700AAC (1.2V 700mAh, Size: AA)</p></td>
</tr>
<tr class="row-even"><td><p>RSPRO_LGP12100_LEADACID</p></td>
<td><p>Rs Pro Lead Acid LGP12100 (12V, 100Ah)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tracing">
<h3>Tracing<a class="headerlink" href="#tracing" title="Link to this heading">¶</a></h3>
<p>Traced values differ between Energy Sources, Devices Energy Models and
Energy Harvesters implementations, please look at the specific child
class for details.</p>
<p><strong>Basic Energy Source</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RemainingEnergy</span></code>: Remaining energy at BasicEnergySource.</p></li>
</ul>
<p><strong>RV Battery Model</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelBatteryLevel</span></code>: RV battery model battery level.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RvBatteryModelBatteryLifetime</span></code>: RV battery model battery lifetime.</p></li>
</ul>
<p><strong>WiFi Radio Energy Model</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TotalEnergyConsumption</span></code>: Total energy consumption of the radio device.</p></li>
</ul>
<p><strong>Basic Energy Harvester</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">HarvestedPower</span></code>: Current power provided by the BasicEnergyHarvester.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TotalEnergyHarvested</span></code>: Total energy harvested by the BasicEnergyHarvester.</p></li>
</ul>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>The following examples have been written.</p>
<p>Examples in <code class="docutils literal notranslate"><span class="pre">src/energy/examples</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basic-energy-model-test.cc</span></code>: Demonstrates the use of a Basic energy source with a Wifi radio model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">generic-battery-discharge-example.cc</span></code>: Demonstrates the installation of battery energy sources. The output of this example shows the discharge curve of 5 different batteries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">generic-battery-discharge-example.py</span></code>: A simplified version of the previous example but using python bindings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">generic-battery-wifiradio-example.cc</span></code>: Demonstrates the use and installation of the Generic Battery Model with the WifiRadio model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rv-battery-model-test.cc</span></code>: Discharge example of a RV energy source model.</p></li>
</ul>
<p>Examples in <code class="docutils literal notranslate"><span class="pre">examples/energy</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">energy-model-example.cc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">energy-model-with-harvesting-example.cc</span></code>: Shows the harvesting model usage. Only usable with basicEnergySources.</p></li>
</ul>
</section>
<section id="tests">
<h3>Tests<a class="headerlink" href="#tests" title="Link to this heading">¶</a></h3>
<p>The following tests have been written, which can be found in <code class="docutils literal notranslate"><span class="pre">src/energy/tests/</span></code>:</p>
</section>
</section>
<section id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Link to this heading">¶</a></h2>
<p>The RV battery model is validated by comparing results with what was presented in the original RV battery model paper. The generic battery model is validated by superimposing the obtained discharge curves with manufacters’s datasheets plots. The following shows the results of the <code class="docutils literal notranslate"><span class="pre">generic-battery-discharge-example.cc</span></code> superimposed to manufacter’s datasheets charts:</p>
<figure class="align-default" id="id9">
<span id="fig-leadacid"></span><img alt="../../../_images/leadacid.png" src="../../../_images/leadacid.png" />
<figcaption>
<p><span class="caption-text">Lead acid battery discharge curve (CSB GP1272)</span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id10">
<span id="fig-liion"></span><img alt="../../../_images/liion.png" src="../../../_images/liion.png" />
<figcaption>
<p><span class="caption-text">Li-Ion battery discharge curve (Panasonic CGR18650DA)</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id11">
<span id="fig-nicd"></span><img alt="../../../_images/nicd.png" src="../../../_images/nicd.png" />
<figcaption>
<p><span class="caption-text">NiCd battery discharge curve (Panasonic N-700AAC)</span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id12">
<span id="fig-nimh"></span><img alt="../../../_images/nimh.png" src="../../../_images/nimh.png" />
<figcaption>
<p><span class="caption-text">NiMH battery discharge curve (Panasonic HHR650D)</span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="scope-and-limitations">
<h3>Scope and Limitations<a class="headerlink" href="#scope-and-limitations" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">GenericBatteryModel</span></code> charging behavior (voltage as a function of SoC) is included but is not been thoroughly tested. Testing requires the implementation of a harvesting device (A charger) capable of providing a CCCV charging method typically used in batteries.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">GenericBatteryModel</span></code> impedance (battery resistance) is constant, battery aging or temperature effects are not considered.</p></li>
<li><p>The Rv battery model has some reported issues (See: issue #164)</p></li>
<li><p>The harvesting mode can only be used with basic energy sources because it does not consider the current capacity or voltage of the battery.</p></li>
</ul>
</section>
<section id="future-work">
<h3>Future Work<a class="headerlink" href="#future-work" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Support of device energy models for PHY layers (lr-wpan, WiMax, etc) and other pieces of hardware (UAV, sensors, CPU).</p></li>
<li><p>Support for realistical charging batteries in the <code class="docutils literal notranslate"><span class="pre">GenericBatteryModule</span></code>.</p></li>
<li><p>Support for device capable of charging batteries (e.g. chargers with CCCV capabilities).</p></li>
<li><p>Implement an energy harvester that recharges the energy sources according to the power levels defined in a user customizable dataset of real measurements.</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h3>
<p>Energy source models and energy consumption models:</p>
<p>[<a class="reference external" href="https://labs.ece.uw.edu/nsl/papers/SIMUTools-11.pdf">1</a>] H. Wu, S. Nabar and R. Poovendran. An Energy Framework for the Network Simulator 3 (ns-3).</p>
<p>[2] M. Handy and D. Timmermann. Simulation of mobile wireless networks with accurate modelling of non-linear battery effects. In Proc. of Applied simulation and Modeling (ASM), 2003.</p>
<p>[3] D. N. Rakhmatov and S. B. Vrudhula. An analytical high-level battery model for use in energy management of portable electronic systems. In Proc. of IEEE/ACM International Conference on Computer Aided Design (ICCAD’01), pages 488-493, November 2001.</p>
<p>[4] D. N. Rakhmatov, S. B. Vrudhula, and D. A. Wallach. Battery lifetime prediction for energy-aware computing. In Proc. of the 2002 International Symposium on Low Power Electronics and Design (ISLPED’02), pages 154-159, 2002.</p>
<p>[<a class="reference external" href="https://www.mdpi.com/2032-6653/3/2/289">5</a>] Olivier Tremblay and Louis-A. Dessaint. 2009. Experimental Validation of a Battery Dynamic Model for EV Applications. World Electric Vehicle Journal 3, 2 (2009), 289–298. <a class="reference external" href="https://doi.org/10.3390/wevj3020289">https://doi.org/10.3390/wevj3020289</a></p>
<p>[<a class="reference external" href="https://ieeexplore.ieee.org/document/4544139">6</a>] Olivier Tremblay, Louis-A. Dessaint, and Abdel-Illah Dekkiche. 2007. A Generic Battery Model for the Dynamic Simulation of Hybrid Electric Vehicles. In 2007 IEEE Vehicle Power and Propulsion Conference. 284–289. <a class="reference external" href="https://doi.org/10.1109/VPPC.2007.4544139">https://doi.org/10.1109/VPPC.2007.4544139</a></p>
<p>[<a class="reference external" href="https://www.mathworks.com/help/sps/powersys/ref/battery.html">7</a>]  MatWorks SimuLink Generic Battery Model</p>
<p>[8] C. M. Shepherd. 1965. Design of Primary and Secondary Cells: II . An Equation Describing Battery Discharge. Journal of The Electrochemical Society 112, 7 (jul 1965), 657. <a class="reference external" href="https://doi.org/10.1149/1.2423659">https://doi.org/10.1149/1.2423659</a></p>
<p>[<a class="reference external" href="https://dl.acm.org/doi/abs/10.1145/3592149.3592156">9</a>] Alberto Gallegos Ramonet, Alexander Guzman Urbina, and Kazuhiko Kinoshita. 2023. Evaluation and Extension of ns-3 Battery Framework. In Proceedings of the 2023 Workshop on ns-3 (WNS3 ‘23). Association for Computing Machinery, New York, NY, USA, 102–108. <a class="reference external" href="https://doi.org/10.1145/3592149.3592156">https://doi.org/10.1145/3592149.3592156</a></p>
<p>Energy Harvesting Models:</p>
<p>[10] C. Tapparello, H. Ayatollahi and W. Heinzelman. Extending the Energy Framework for Network Simulator 3 (ns-3). Workshop on ns-3 (WNS3), Poster Session, Atlanta, GA, USA. May, 2014.</p>
<p>[11] C. Tapparello, H. Ayatollahi and W. Heinzelman. Energy Harvesting Framework for Network Simulator 3 (ns-3). 2nd International Workshop on Energy Neutral Sensing Systems (ENSsys), Memphis, TN, USA. November 6, 2014.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ns-3</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, vishnu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/src/energy/doc/energy.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>