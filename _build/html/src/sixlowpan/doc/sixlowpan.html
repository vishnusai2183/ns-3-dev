<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6LoWPAN: Transmission of IPv6 Packets over IEEE 802.15.4 Networks &#8212; ns-3 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=039e1c02" />
    <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="lowpan-transmission-of-ipv6-packets-over-ieee-802-15-4-networks">
<h1>6LoWPAN: Transmission of IPv6 Packets over IEEE 802.15.4 Networks<a class="headerlink" href="#lowpan-transmission-of-ipv6-packets-over-ieee-802-15-4-networks" title="Link to this heading">¶</a></h1>
<p>This chapter describes the implementation of <a href="#id5"><span class="problematic" id="id6">|ns3|</span></a> model for the
compression of IPv6 packets over IEEE 802.15.4-Based Networks
as specified by <span class="target" id="index-0"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc4944.html"><strong>RFC 4944</strong></a> (“Transmission of IPv6 Packets over IEEE 802.15.4 Networks”)
and <span class="target" id="index-1"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6282.html"><strong>RFC 6282</strong></a> (“Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks”).</p>
<section id="model-description">
<h2>Model Description<a class="headerlink" href="#model-description" title="Link to this heading">¶</a></h2>
<p>The source code for the sixlowpan module lives in the directory <code class="docutils literal notranslate"><span class="pre">src/sixlowpan</span></code>.</p>
<section id="design">
<h3>Design<a class="headerlink" href="#design" title="Link to this heading">¶</a></h3>
<p>The model design does not follow strictly the standard from an architectural
standpoint, as it does extend it beyond the original scope by supporting also
other kinds of networks.</p>
<p>Other than that, the module strictly follows <span class="target" id="index-2"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc4944.html"><strong>RFC 4944</strong></a> and <span class="target" id="index-3"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6282.html"><strong>RFC 6282</strong></a>, with the
exception that HC2 encoding is not supported, as it has been superseded by IPHC and NHC
compression type (<span class="target" id="index-4"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6282.html"><strong>RFC 6282</strong></a>).</p>
<p>IPHC sateful (context-based) compression is supported but, since <span class="target" id="index-5"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6775.html"><strong>RFC 6775</strong></a>
(“Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)”)
is not yet implemented, it is necessary to add the context to the nodes manually.</p>
<p>This is possible though the <code class="docutils literal notranslate"><span class="pre">SixLowPanHelper::AddContext</span></code> function.
Mind that installing different contexts in different nodes will lead to decompression failures.</p>
<section id="netdevice">
<h4>NetDevice<a class="headerlink" href="#netdevice" title="Link to this heading">¶</a></h4>
<p>The whole module is developed as a transparent NetDevice, which can act as a
proxy between IPv6 and any NetDevice (the module has been successfully tested
with PointToPointNedevice, CsmaNetDevice and LrWpanNetDevice).</p>
<p>For this reason, the module implements a virtual NetDevice, and all the calls are passed
without modifications to the underlying NetDevice. The only important difference is in
GetMtu behaviour. It will always return <em>at least</em> 1280 bytes, as is the minimum IPv6 MTU.</p>
<p>The module does provide some attributes and some tracesources.
The attributes are:</p>
<ul class="simple">
<li><p>Rfc6282 (boolean, default true), used to activate HC1 (<span class="target" id="index-6"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc4944.html"><strong>RFC 4944</strong></a>) or IPHC (<span class="target" id="index-7"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6282.html"><strong>RFC 6282</strong></a>) compression.</p></li>
<li><p>OmitUdpChecksum (boolean, default true), used to activate UDP checksum compression in IPHC.</p></li>
<li><p>FragmentReassemblyListSize (integer, default 0), indicating the number of packets that can be reassembled at the same time. If the limit is reached, the oldest packet is discarded. Zero means infinite.</p></li>
<li><p>FragmentExpirationTimeout (Time, default 60 seconds), being the timeout to wait for further fragments before discarding a partial packet.</p></li>
<li><p>CompressionThreshold (unsigned 32 bits integer, default 0), minimum compressed payload size.</p></li>
<li><p>ForceEtherType (boolean, default false).</p></li>
<li><p>EtherType (unsigned 16 bits integer, default 0xFFFF), to force a particular L2 EtherType.</p></li>
<li><p>UseMeshUnder (boolean, default false), it enables mesh-under flood routing.</p></li>
<li><p>MeshUnderRadius (unsigned 8 bits integer, default 10), the maximum number of hops that a packet will be forwarded.</p></li>
<li><p>MeshCacheLength (unsigned 16 bits integer, default 10), the length of the cache for each source.</p></li>
<li><p>MeshUnderJitter (ns3::UniformRandomVariable[Min=0.0|Max=10.0]), the jitter in ms a node uses to forward mesh-under packets - used to prevent collisions.</p></li>
</ul>
<p>The CompressionThreshold attribute is similar to Contiki’s SICSLOWPAN_CONF_MIN_MAC_PAYLOAD
option. If a compressed packet size is less than the threshold, the uncompressed version is
used (plus one byte for the correct dispatch header).
This option is useful when a MAC requires a minimum frame size (e.g., ContikiMAC) and the
compression would violate the requirement.</p>
<p>The last two attributes are needed to use the module with a NetDevice other than 802.15.4, as
neither IANA or IEEE did reserve an EtherType for 6LoWPAN. As a consequence there might be a
conflict with the L2 multiplexer/demultiplexer which is based on EtherType. The default
value is 0xFFFF, which is reserved by IEEE (see <a class="reference internal" href="#iana802" id="id1"><span>[IANA802]</span></a> and <a class="reference internal" href="#ethertype" id="id2"><span>[Ethertype]</span></a>).
The default module behaviour is to not change the EtherType, however this would not work with
any NetDevice actually understanding and using the EtherType.</p>
<p>Note that the <cite>ForceEtherType</cite> parameter have also a direct effect on the MAC address kind the
module is expecting to handle:
* ForceEtherType true: Mac48Address (Ethernet, WiFi, etc.).
* ForceEtherType false: Mac16Address or Mac64Address (IEEE 802.15.4).</p>
<p>Note that using 6LoWPAN over any NetDevice other than 802.15.4 will produce valid .pcap files,
but they will not be correctly dissected by Wireshark.
The reason lies on the fact that 6LoWPAN was really meant to be used only over 802.15.4, so
Wireshark dissectors will not even try to decode 6LoWPAN headers on top of protocols other than
802.15.4.</p>
<p>The Trace sources are:</p>
<ul class="simple">
<li><p>Tx - exposing packet (including 6LoWPAN header), SixLoWPanNetDevice Ptr, interface index.</p></li>
<li><p>Rx - exposing packet (including 6LoWPAN header), SixLoWPanNetDevice Ptr, interface index.</p></li>
<li><p>Drop - exposing DropReason, packet (including 6LoWPAN header), SixLoWPanNetDevice Ptr, interface index.</p></li>
</ul>
<p>The Tx and Rx traces are called as soon as a packet is received or sent. The Drop trace is
invoked when a packet (or a fragment) is discarded.</p>
</section>
<section id="mesh-under-routing">
<h4>Mesh-Under routing<a class="headerlink" href="#mesh-under-routing" title="Link to this heading">¶</a></h4>
<p>The module provides a very simple mesh-under routing <a class="reference internal" href="#shelby" id="id3"><span>[Shelby]</span></a>, implemented as a flooding
(a mesh-under routing protocol is a routing system implemented below IP).</p>
<p>This functionality can be activated through the UseMeshUnder attribute and fine-tuned using
the MeshUnderRadius and MeshUnderJitter attributes.</p>
<p>Note that flooding in a PAN generates a lot of overhead, which is often not wanted.
Moreover, when using the mesh-under facility, ALL the packets are sent without acknowledgment
because, at lower level, they are sent to a broadcast address.</p>
<p>At node level, each packet is re-broadcasted if its BC0 Sequence Number is not in the cache of the
recently seen packets. The cache length (by default 10) can be changed through the MeshCacheLength
attribute.</p>
</section>
</section>
<section id="scope-and-limitations">
<h3>Scope and Limitations<a class="headerlink" href="#scope-and-limitations" title="Link to this heading">¶</a></h3>
<section id="context-based-compression">
<h4>Context-based compression<a class="headerlink" href="#context-based-compression" title="Link to this heading">¶</a></h4>
<p>IPHC sateful (context-based) compression is supported but, since <span class="target" id="index-8"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6775.html"><strong>RFC 6775</strong></a>
(“Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)”)
is not yet implemented, it is necessary to add the context to the nodes manually.</p>
</section>
<section id="lowpam-nd">
<h4>6LoWPAM-ND<a class="headerlink" href="#lowpam-nd" title="Link to this heading">¶</a></h4>
<p>Future versions of this module will support <span class="target" id="index-9"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6775.html"><strong>RFC 6775</strong></a>, however no timeframe is guaranteed.</p>
</section>
<section id="id4">
<h4>Mesh-under routing<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<p>It would be a good idea to improve the mesh-under flooding by providing the following:</p>
<ul class="simple">
<li><p>Adaptive hop-limit calculation,</p></li>
<li><p>Adaptive forwarding jitter,</p></li>
<li><p>Use of direct (non mesh) transmission for packets directed to 1-hop neighbors.</p></li>
</ul>
</section>
<section id="mixing-compression-types-in-a-pan">
<h4>Mixing compression types in a PAN<a class="headerlink" href="#mixing-compression-types-in-a-pan" title="Link to this heading">¶</a></h4>
<p>The IPv6/MAC addressing scheme defined in <span class="target" id="index-10"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6282.html"><strong>RFC 6282</strong></a> and <span class="target" id="index-11"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc4944.html"><strong>RFC 4944</strong></a> is different.
One adds the PanId in the pseudo-MAC address (4944) and the other doesn’t (6282).</p>
<p>The expected use cases (confirmed by the RFC editor) is to <em>never</em> have a mixed environment
where part of the nodes are using HC1 and part IPHC because this would lead to confusion on
what the IPv6 address of a node is.</p>
<p>Due to this, the nodes configured to use IPHC will drop the packets compressed with HC1
and vice-versa. The drop is logged in the drop trace as <code class="docutils literal notranslate"><span class="pre">DROP_DISALLOWED_COMPRESSION</span></code>.</p>
</section>
<section id="using-6lowpan-with-ipv4-or-other-l3-protocols">
<h4>Using 6LoWPAN with IPv4 (or other L3 protocols)<a class="headerlink" href="#using-6lowpan-with-ipv4-or-other-l3-protocols" title="Link to this heading">¶</a></h4>
<p>As the name implies, 6LoWPAN can handle only IPv6 packets. Any other protocol will be discarded.
Moreover, 6LoWPAN assumes that the network is uniform, as is all the devices connected by the
same same channel are using 6LoWPAN. Mixed environments are not supported by the standard.
The reason is simple: 802.15.4 frame doesn’t have a “protocol” field. As a consequence,
there is no demultiplexing at MAC layer and the protocol carried by L2 frames must be known
in advance.</p>
<p>In the <a href="#id7"><span class="problematic" id="id8">|ns3|</span></a> implementation it is possible, but not advisable, to violate this requirement
if the underlying NetDevice is capable of discriminating different protocols. As an example,
CsmaNetDevice can carry IPv4 and 6LoWPAN at the same time. However, this configuration has
not been tested.</p>
</section>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h3>
<div role="list" class="citation-list">
<div class="citation" id="iana802" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">IANA802</a><span class="fn-bracket">]</span></span>
<p>IANA, assigned IEEE 802 numbers: <a class="reference external" href="http://www.iana.org/assignments/ieee-802-numbers/ieee-802-numbers.xml">http://www.iana.org/assignments/ieee-802-numbers/ieee-802-numbers.xml</a></p>
</div>
<div class="citation" id="ethertype" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Ethertype</a><span class="fn-bracket">]</span></span>
<p>IEEE Ethertype numbers: <a class="reference external" href="http://standards.ieee.org/develop/regauth/ethertype/eth.txt">http://standards.ieee.org/develop/regauth/ethertype/eth.txt</a></p>
</div>
<div class="citation" id="shelby" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Shelby</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="26">
<li><p>Shelby and C. Bormann, 6LoWPAN: The Wireless Embedded Internet. Wiley, 2011. [Online]. Available: <a class="reference external" href="https://books.google.it/books?id=3Nm7ZCxscMQC">https://books.google.it/books?id=3Nm7ZCxscMQC</a></p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<section id="enabling-sixlowpan">
<h3>Enabling sixlowpan<a class="headerlink" href="#enabling-sixlowpan" title="Link to this heading">¶</a></h3>
<p>Add <code class="docutils literal notranslate"><span class="pre">sixlowpan</span></code> to the list of modules built with <a href="#id9"><span class="problematic" id="id10">|ns3|</span></a>.</p>
</section>
<section id="helper">
<h3>Helper<a class="headerlink" href="#helper" title="Link to this heading">¶</a></h3>
<p>The helper is patterned after other device helpers.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>The following example can be found in <code class="docutils literal notranslate"><span class="pre">src/sixlowpan/examples/</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">example-sixlowpan.cc</span></code>:  A simple example showing end-to-end data transfer.</p></li>
</ul>
<p>In particular, the example enables a very simplified end-to-end data
transfer scenario, with a CSMA network forced to carry 6LoWPAN compressed packets.</p>
</section>
<section id="tests">
<h3>Tests<a class="headerlink" href="#tests" title="Link to this heading">¶</a></h3>
<p>The test provided checks the connection between two UDP clients and the correctness of the received packets.</p>
</section>
</section>
<section id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Link to this heading">¶</a></h2>
<p>The model has been validated against WireShark, checking whatever the packets are correctly
interpreted and validated.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ns-3</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, vishnu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/src/sixlowpan/doc/sixlowpan.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>